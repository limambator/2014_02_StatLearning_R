<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Nonlinear Models</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Nonlinear Models</h1>

<p>Here we explore the use of nonlinear models using some tools in R</p>

<pre><code class="r">require(ISLR)
</code></pre>

<pre><code>## Loading required package: ISLR
</code></pre>

<pre><code>## Warning: package &#39;ISLR&#39; was built under R version 3.0.3
</code></pre>

<pre><code class="r">attach(Wage)
</code></pre>

<h2>Polynomials</h2>

<p>First we will use polynomials, and focus on a single predictor age:</p>

<pre><code class="r">fit = lm(wage ~ poly(age, 4), data = Wage)
summary(fit)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = wage ~ poly(age, 4), data = Wage)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -98.71 -24.63  -4.99  15.22 203.69 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    111.704      0.729  153.28   &lt;2e-16 ***
## poly(age, 4)1  447.068     39.915   11.20   &lt;2e-16 ***
## poly(age, 4)2 -478.316     39.915  -11.98   &lt;2e-16 ***
## poly(age, 4)3  125.522     39.915    3.14   0.0017 ** 
## poly(age, 4)4  -77.911     39.915   -1.95   0.0510 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 39.9 on 2995 degrees of freedom
## Multiple R-squared:  0.0863, Adjusted R-squared:  0.085 
## F-statistic: 70.7 on 4 and 2995 DF,  p-value: &lt;2e-16
</code></pre>

<pre><code class="r">coef(fit)
</code></pre>

<pre><code>##   (Intercept) poly(age, 4)1 poly(age, 4)2 poly(age, 4)3 poly(age, 4)4 
##        111.70        447.07       -478.32        125.52        -77.91
</code></pre>

<p>The <code>poly()</code> function generates a basis of <em>orthogonal polynomials</em>.
Lets make a plot of the fitted function, along with the standard errors of the fit.</p>

<pre><code class="r">agelims = range(age)
age.grid = seq(from = agelims[1], to = agelims[2])
preds = predict(fit, newdata = list(age = age.grid), se = TRUE)
se.bands = cbind(preds$fit + 2 * preds$se, preds$fit - 2 * preds$se)
plot(age, wage, col = &quot;darkgrey&quot;)
lines(age.grid, preds$fit, lwd = 2, col = &quot;blue&quot;)
matlines(age.grid, se.bands, col = &quot;blue&quot;, lty = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/> </p>

<p>Since f(x0) is a linear function of the betta, can get a simple expression for <em>pointwise-variances</em> Var[f(x0)] at any value x0. In the figure we have computed the fit and pointwise standard errors on a grid of values for x0. We show
f(x0) = +- 2*se[f(x0)]</p>

<p>There are other more direct ways of doing this in R. For example</p>

<pre><code class="r">fita = lm(wage ~ age + I(age^2) + I(age^3) + I(age^4), data = Wage)
summary(fita)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = wage ~ age + I(age^2) + I(age^3) + I(age^4), data = Wage)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -98.71 -24.63  -4.99  15.22 203.69 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.84e+02   6.00e+01   -3.07  0.00218 ** 
## age          2.12e+01   5.89e+00    3.61  0.00031 ***
## I(age^2)    -5.64e-01   2.06e-01   -2.74  0.00626 ** 
## I(age^3)     6.81e-03   3.07e-03    2.22  0.02640 *  
## I(age^4)    -3.20e-05   1.64e-05   -1.95  0.05104 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 39.9 on 2995 degrees of freedom
## Multiple R-squared:  0.0863, Adjusted R-squared:  0.085 
## F-statistic: 70.7 on 4 and 2995 DF,  p-value: &lt;2e-16
</code></pre>

<pre><code class="r">coef(fita)
</code></pre>

<pre><code>## (Intercept)         age    I(age^2)    I(age^3)    I(age^4) 
##  -1.842e+02   2.125e+01  -5.639e-01   6.811e-03  -3.204e-05
</code></pre>

<p>Here <code>I()</code> is a <em>wrapper</em> function; we need it because <em>age<sup>2</sup></em> means something to the formula language,
while <code>I(age^2)</code> is protected.
The coefficients are different to those we got before! However, the fits are the same:</p>

<pre><code class="r">plot(fitted(fit), fitted(fita))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAhFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OY85ZmU5ZrU5j7U5j9plAABlADllAGVlOQBlOY9lZrVltf2POQCPOTmPOWWPZgCPjzmPtY+P29qP2/21ZgC1ZmW1/rW1/tq1/v3ajzna/rXa/v39tWX924/9/rX9/tr9/v0uL7+QAAAALHRSTlP/////////////////////////////////////////////////////////AMfWCYwAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAywSURBVHic7Z0Ld+q4FUbHSXu5k7QluTMlmXYKMw0ND////1e/ICEYoYeNJX17r7tW1o05MmGjx7El66cSJPlp6jcA04B4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4UULEFxAzI4oPiIWxCRa//d58f+7fXIuGSQkVv39ZND83394di4ZJCRW/+/F28tO+aJgUarwowX387ok+PkUY1YuCeFGGSOfulgzukmOIwd3+ZY741BgmnVvNPom3vCgIN+Wrj4HSufVfHqjxMXNWEwdI5+b1j/V5Pof4eKitDyzecLKAWBiU1jvi1egbdCE+e4quvg87uDOdMCAWBuNCjhWczj115TK4i5Oip39vfm8Ou17j66s3F05p875gXC5eUwlv6nfPywvntHhfMC693Xt7xBxIH580RU8CfzxkBPEpc7m+Iz5nGu+XNCA+V5qafvlWGeIzxdC9d8eNID5RLqXvHy8wxyM+Ta5PiUB8lhi798MrTCA+TYry2ueP+PywmvqG+OxoavvVKY+Iz47rzXx5/RWIT422qiNeja6dt3uhAcQnhW11v/4ixKdEk70jXo9rl2lPXms+jPiEKLoab/di82HEJ4R9dS8RnxPWA7vDiw0gPhGuTLvoCTAfRnwaOFX2Y4QBxKcB4kVBvCDO3XsbZT6M+Ohxr+zHMAOIj53C+iLtlzjzYcRH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" alt="plot of chunk unnamed-chunk-5"/> </p>

<p>By using orthogonal polynomials in this simple way, it turns out that we can separately test
for each coefficient. So if we look at the summary again, we can see that the linear, quadratic
and cubic terms are significant, but not the quartic.</p>

<pre><code class="r">summary(fit)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = wage ~ poly(age, 4), data = Wage)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -98.71 -24.63  -4.99  15.22 203.69 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    111.704      0.729  153.28   &lt;2e-16 ***
## poly(age, 4)1  447.068     39.915   11.20   &lt;2e-16 ***
## poly(age, 4)2 -478.316     39.915  -11.98   &lt;2e-16 ***
## poly(age, 4)3  125.522     39.915    3.14   0.0017 ** 
## poly(age, 4)4  -77.911     39.915   -1.95   0.0510 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 39.9 on 2995 degrees of freedom
## Multiple R-squared:  0.0863, Adjusted R-squared:  0.085 
## F-statistic: 70.7 on 4 and 2995 DF,  p-value: &lt;2e-16
</code></pre>

<p>This only works with linear regression, and if there is a single predictor. In general we would use <strong>anova()</strong> as this next example demonstrates.</p>

<p>In performing a polynomial regression we must decide on the degree of the polynomial to use.</p>

<p>We use the <strong>anova()</strong> function, which performs an <strong>anova()</strong> analysis of variance (ANOVA, using an F-test) in order to test the null hypothesis that a model <strong>M1</strong> is sufficient to explain the data against the alternative hypothesis that a more complex model <strong>M2</strong> is required.
 In order to use the anova() function, <strong>M1</strong> and <strong>M2</strong> must be nested models: the predictors in <strong>M1</strong> must be a subset of the predictors in M2.
 In this case, we fit five different models and sequentially compare the simpler model to the more complex model.</p>

<pre><code class="r">fita = lm(wage ~ education, data = Wage)
fitb = lm(wage ~ education + age, data = Wage)
fitc = lm(wage ~ education + poly(age, 2), data = Wage)
fitd = lm(wage ~ education + poly(age, 3), data = Wage)
anova(fita, fitb, fitc, fitd)
</code></pre>

<pre><code>## Analysis of Variance Table
## 
## Model 1: wage ~ education
## Model 2: wage ~ education + age
## Model 3: wage ~ education + poly(age, 2)
## Model 4: wage ~ education + poly(age, 3)
##   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)    
## 1   2995 3995721                               
## 2   2994 3867992  1    127729 102.74 &lt;2e-16 ***
## 3   2993 3725395  1    142597 114.70 &lt;2e-16 ***
## 4   2992 3719809  1      5587   4.49  0.034 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<p>The p-value comparing the linear <strong>Model 1</strong> to the quadratic <strong>Model 2</strong> is essentially zero (&lt;10-15), indicating that a linear fit is not sufficient.
 Similarly the p-value comparing the quadratic <strong>Model 2</strong> to the cubic <strong>Model 3</strong>
is very low (0.0017), so the quadratic fit is also insufficient.
 The p-value comparing the cubic and degree-4 polynomials, <strong>Model 3</strong> and <strong>Model 4</strong>, is approximately 5% while the degree-5 polynomial <strong>Model 5</strong> seems unnecessary
because its p-value is 0.37.
 Hence, either a cubic or a quartic polynomial appear to provide a reasonable fit to the data, but lower- or higher-order models are not justified.</p>

<h3>Polynomial logistic regression</h3>

<p>Now we fit a logistic regression model to a binary response variable,
constructed from <code>wage</code>. We code the big earners (<code>&gt;250K</code>) as 1, else 0.</p>

<pre><code class="r">fit = glm(I(wage &gt; 250) ~ poly(age, 3), data = Wage, family = binomial)
summary(fit)
</code></pre>

<pre><code>## 
## Call:
## glm(formula = I(wage &gt; 250) ~ poly(age, 3), family = binomial, 
##     data = Wage)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -0.281  -0.274  -0.249  -0.176   3.287  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      -3.85       0.16  -24.10  &lt; 2e-16 ***
## poly(age, 3)1    37.88      11.48    3.30  0.00097 ***
## poly(age, 3)2   -29.51      10.56   -2.79  0.00520 ** 
## poly(age, 3)3     9.80       9.00    1.09  0.27632    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 730.53  on 2999  degrees of freedom
## Residual deviance: 707.92  on 2996  degrees of freedom
## AIC: 715.9
## 
## Number of Fisher Scoring iterations: 8
</code></pre>

<pre><code class="r">preds = predict(fit, list(age = age.grid), se = T)
se.bands = preds$fit + cbind(fit = 0, lower = -2 * preds$se, upper = 2 * preds$se)
se.bands[1:5, ]
</code></pre>

<pre><code>##      fit   lower  upper
## 1 -7.665 -10.760 -4.570
## 2 -7.325 -10.107 -4.543
## 3 -7.002  -9.493 -4.511
## 4 -6.695  -8.917 -4.473
## 5 -6.405  -8.379 -4.431
</code></pre>

<p>We have done the computations on the logit scale. To transform we need to apply the inverse logit
mapping
\[ p=\frac{e^\eta}{1+e^\eta}. \]
(Here we have used the ability of MarkDown to interpret TeX expressions.)
We can do this simultaneously for all three columns of <code>se.bands</code>:</p>

<pre><code class="r">prob.bands = exp(se.bands)/(1 + exp(se.bands))
matplot(age.grid, prob.bands, col = &quot;blue&quot;, lwd = c(2, 1, 1), lty = c(1, 2, 
    2), type = &quot;l&quot;, ylim = c(0, 0.1))
points(jitter(age), I(wage &gt; 250)/10, pch = &quot;|&quot;, cex = 0.5)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABOFBMVEX9/v0AAAAAAAMAAAQAAAgAAA4AABkAAC0AADkAAGUAAJAAAP8AOTkAOWUAOY8AZo8AZrUDAwMDBAQDCAgDDg4DGRkDLS0DUVED/v0EAwME/v0G/v0KAwMNAwMNGRkN/v0QAwMR/v0TAwMTGRkVAwMVLS0Y/v0bCAgcAwMh/v0iAwMiUVEkGRkoAwMqLS0u/v0wAwMxUVE4AwM5AAA5ADk5AGU5OWU5OY85j485j9o8Dg4+BARBAwNC/v1EUVFLAwNQj49c/v1fUVFiGRllAABlADllAGVlOQBlOTllOY9ltf1mCAhvj49yLS1zLS13Dg6B/v2FUVGKGRmPOQCPOTmPOWWPZgCP29qP2/2cj4+hLS21ZgC124+1/v27UVHajznaj4/a24/a/v39tWX924/9/rX9/tr9/v3Z3901AAAAaHRSTlP/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AB/s/UsAAAAJcEhZcwAACxIAAAsSAdLdfvwAABAOSURBVHic7Z0JfxtHGYdRKSVFNFjcgZajFMpZjjQNgpY2NGnBHE1tA0qNLRPb2u//DdhDSmxrVzv3vO/8/8/PP9nW7szOzrNz7GhH87mKQPK53AkgeaB4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFB8xE9IVKZ+wSOK9whLxpl6hfYWf3G3vX5ePrGNmniSV/zqcL/9fX77qWXUxJO84i8/Orn22zxqkhWWeFC82/jLh2zjNcJevVb8mniKVwvFg0LxoGQWv+7b9fXuKD4quUv86nDuFvUIZ9u3CcO7nf795Nk/Z09Omr/Onr/z2QftW08+fdy8dptPHz/bfPDWg02w9a/Tx59deavdtQuxjrSN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" alt="plot of chunk unnamed-chunk-9"/> </p>

<p>We have drawn the age values corresponding to the observations with wage values above 250 as gray marks on the top of the plot, and those with wage values below 250 are shown as gray marks on the bottom of the plot.</p>

<pre><code class="r">table(cut(age, 4))
</code></pre>

<pre><code>## 
## (17.9,33.5]   (33.5,49]   (49,64.5] (64.5,80.1] 
##         750        1399         779          72
</code></pre>

<pre><code class="r">fit = lm(wage ~ cut(age, 4), data = Wage)
coef(summary(fit))
</code></pre>

<pre><code>##                        Estimate Std. Error t value  Pr(&gt;|t|)
## (Intercept)              94.158      1.476  63.790 0.000e+00
## cut(age, 4)(33.5,49]     24.053      1.829  13.148 1.982e-38
## cut(age, 4)(49,64.5]     23.665      2.068  11.443 1.041e-29
## cut(age, 4)(64.5,80.1]    7.641      4.987   1.532 1.256e-01
</code></pre>

<p>Here cut() automatically picked the cutpoints at 33.5, 49, and 64.5 years of age. We could also have specified our own cutpoints directly using the breaks option. The function cut() returns an ordered categorical variable; the lm() function then creates a set of dummy variables for use in the regression.</p>

<h2>Splines</h2>

<p>Splines are more flexible than polynomials, but the idea is rather similar.
Here we will explore cubic splines.
 A cubic spline with knots is a piecewise cubic polynomial with continuous derivatives up to order 2 at each knot.
 The <strong>bs()</strong> function generates the entire matrix of basis functions for splines with the specified set of knots. By default, cubic splines are produced.</p>

<pre><code class="r">require(splines)
</code></pre>

<pre><code>## Loading required package: splines
</code></pre>

<pre><code class="r">fit = lm(wage ~ bs(age, knots = c(25, 40, 60)), data = Wage)
plot(age, wage, col = &quot;darkgrey&quot;)
lines(age.grid, predict(fit, list(age = age.grid)), col = &quot;darkgreen&quot;, lwd = 2)
abline(v = c(25, 40, 60), lty = 2, col = &quot;darkgreen&quot;)

pred = predict(fit, newdata = list(age = age.grid), se = T)
lines(age.grid, pred$fit + 2 * pred$se, lty = &quot;dashed&quot;)
lines(age.grid, pred$fit - 2 * pred$se, lty = &quot;dashed&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAgVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZAAAZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOTllOY9ltf2POQCPOTmPOWWPZgCP29qP2/2pqam1ZgC1/rW1/v3ajzna24/a/rXa/v39tWX924/9/rX9/tr9/v19Gn3xAAAAK3RSTlP///////////////////////////////////////////////////////8AI8mn0AAAAAlwSFlzAAALEgAACxIB0t1+/AAAIABJREFUeJztnQub3TZuhvd4u1Gdbr12sq2dNCOv3WbGw///Azu6UAIIgDeREs8hvicZz4jiRXwJgNT1L0bVpf5ydQNU10jBdyoF36kUfKdS8J1KwXcqBd+pFHynUvCdSsF3KgXfqRR8p1LwnUrBdyoF36kUfKdS8J1KwXcqBd+pFHynUvCdSsF3KgXfqRR8p1LwnUrBdyoF36kUfKdS8J1KwXcqBd+pFHynUvCdSsF3KgXfqRR8p1LwnUrBdyoF36kUfKdS8J1KwXcqBd+pFHynUvCdSsF3KgXfqRR8p1LwnUrBdyoF36kUfKdS8J1KwXcqBd+pFHynUvCdSsF3qiPgb9ka8rNeXHjDdbuqCD4753Cg1msLb7huRwr+TCl4vxR8fTUJXlVfCr5TKfhO1SR4jfH1peDPlIL3S8HXl4I/Uwrer8vBj+N4Ut21agqqSfBXa1z/f6SaXCl4RgpewT9MTa6aBK8xvr66AI96V2f1s3oAj/2pgp+l4M+UgverNPgR+noFP6tJ8IWFwatmPRJ4Ce91ayZz4bQ9oAcCL/K9Evylg86nJsHnhUK5jy9czrUzsXTUBfgChefqccG//Dzfnv/Xb6lFe5TZP3Hh9OTOb+bkkaOj4F+/fJ7/ff7pz8SiPbr8lO0j1u3oKPgfv35D/8YX7ZGCr68mLV5VX4dj/I9P5WO8qr6anNWr6qtJ8Brj6+uRlnMNFN5w3Y6anNzV7J9xuPAM6gOBZ5Zzke9c8Khi/4xvhV9H/oHA35vFK/hVvS3nmr1adraanNXX0XLWvNXr42erH/Bq60gllnMfv97Dcs6C1+XcrBKTu69v1F8+tD65U/BIJZZzzx/v4urcGt0V/KxSy7n2Lf6Uwhuu21GB5dxE/nv7Mf6Uwhuu21E/s3oVkoLvVAq+UzUJXmN8fSn4M6Xg/VLw9dUp+Isu1Sh4v6qDv+qCjYK/WHqlTsH3qj7B4xhPA35gChDInVL3ZWoS/Lmzemr+AYeAkpOcx5XzC0cKPhI8sNMi4K+2ewUfBD8jgptKgL/c7h8VPGNQ682WA7nlkt6F6fz+9tf65izmhk24Sax1/X2vW8FzSgAvdDhnswvA+b569AI0mwBMegTFQgsVrRUlINawWHBPf+QLe+qpSfDxkkgw3lhERzdZgDAHGB0B8GIkwAkXv5tNwQfBE+RFwPuPqL4eFDzjbmGUZly9YbYY4LmjQjkTvqWpg/+I6qtJ8MdjvGcnepFGPIGTGW7lbFe+K9/RvYOPkvjKMf98Po6BNPS4waMXafw667XlYnTn8nkLF2cZYt1XS8EreE4KPq5wBR9f9IkSY/XZMb4htQs+pccoOtTtUUuqhEux4ugQ13xiOy4bF82CT1nPUmeNHK3oyxPqi4oHsDpmJ6aMs1btVE2CT71snQReeAfOKeDJuXoFj6Tg66tZ8NVivPSeuzNi/EDK0BgPpQ9U1JeCP1MKXnW1FHynUvCdqknwGuPrS8GfKQXvl4KvLwV/ph4J/AN8muSEs2fwfr821OSHCs7VCefLrzslL6rJL02eKwXPSC3+XqpIVZOfJtEYX186qz9TCt4vBV9fJSZ3k7enIV7Bt1W3owLg5wn9yz9Si/ZIwddXAfDzxymKfmlSVV+HwX9698fv3wp/mkRVX8cnd69fbu/N8718aVK1Smf1Z+qBYnx+0R4p+PoqcXXu3dNdfHfujMIbrttRiXP1r18+Kvjm63ZU5urc1/cKvvW6HRW6Ovf93/5+t5dl+1SBq3Mfp3+YT00q+JbV5KxeVV9NgtcYX18K/kwpeL8UfH0p+DOl4P1S8PXVJHhVfSn4TqXgO1WT4DXG15eCP1MK3i8FX18K/kwpeL8UfH01Cf6RpO+r71MNPiC9SMHXlYJP0QPFeAxeY7xfDwRevzuXokcC30zdjhT8mVLwfin4+moSvKq+FHynUvCdqknwGuPrS8GfKQXvl4KvLwV/phS8Xwq+vpoEr6ovBZ+kVm+rSJeCT1GzV9fT1ST4ZmP8UfAa4/1S8PWl4JN0MMYreL/aBX/HdTtS8GdKwauuVol32Rb/CpWqvvS7c52qzLts9e3V7dftqEmLV/D1VeBdtnf/pcnz9Ejgs4v2SMHXV/Pg6bmywNmzJXndCf1BC6cFMoVHna0LNFP8tuxll/taX87Rs+OB8+VL8roT+iOmCmbXqPPzgWaKZVx3ua/JyR2Qgq+kCsu5ol+aLAiecfvzHwqe0fXLuWIx3g6CgfDQGE91J8s5sftAQjb4ghrqVxGr5mf1MYrypCL4gKtPakiA6XC8ilLqB7x1+0NijC/RDqtHAt/ClyYZvkzCumlwe/0geBJNPHog8FW+NJkssfOJ7+W6/VCMTx82jxHjq3xp8ogSFu3l62uDaZQKLefa+dJkBvjk9RpcMTbiuZNVYDlX/kuTNW+E9cd4sQxufbD+lmDlepHGr3L9w1AhhQfOutFN46Q0UxdP4GTqeEx5bPAcnALgjbv8j21HqQMrEF8UfPrUf7H4FKtT8HHy9096h9Pr8ehUfkIV5IxPUjsU/BElzcsFUHZAMEXF1J0eYUuv8x40xnsVCMBROULgRU/gr+iepOA9MT4q+N+pmgSfGuNDPPwxPsUh6NOyx4v2qNz1+JjCy00B0uu+TncFnrl5KiDGO0iXZdlzssTXZ1p86RM4x3VP4DNOnJAVt3gHDu/XR9YVJKv0cq6A4sC/frn99H+/PBUt2qNy4JccAOAKnl5giZozJi0lmXz3Bv71y8eXD38y91MeKTpdKeAhWcqXCeIp4AP3ekgtb0pR4H/8+u0NPHPJ/UjRSUIXQuNNjLmcgvx68v21NCqkjMOWlGDx36+z+OSFlfXuNsSPDviRjiTptnv6E80cxBP3MXf+lld04dEx/nZL5F4yxsdFW5osxXhLy+x+n4kjUjIOF8I1WraB1e+5iy/8Pmb16eApWeumBzfGx4Ff+MKftIxgAxW8X5lXTmkyRzYBPAAsWzzNJzfw3sCvT8twj8vkF+1RzKonEMzQdVd0nmYY2WQmxsPwDW0d7+rJzR/YPcX4r9N9dd/fpy3oGrgRA8oaQ3zh0HwkwxYzsLq3dfyykPvx67+SFnQZ4BOMIf3ErbgYlIqiq4HItURCay9b58Uu595+fv/pfz/UtfiE8JcSKanlxhUlc0xtVHpCdUVO7r6+Rfj3Pz59Llg0o9PBo+CffLUX7UtOGARKoieNz1VTs/qEMMz1mOTFMXjhaVnOrzN1eJsTNOz9wNB68wo1BT7l6mWUgTLGDC/LwmTOLcR7etFr4NYObobGY7z5nrGaO/1GjMjwPZBkEXxCA+JyUPCXKW5W/8vT8/u35VzRoj3Ke0w6Drx0IwY+r5tMJc5yiau/TrHLueW/kkV7lOrqZUfLXGAZ3JMsKHfUmi9QkSzobS6+Xhe3nPvt6e2/F/pA7JGijwkZZdTUitmJJsi+w+8QAi1oUHEx/o358+32sWjRx4T72D9DpufccSHClTqxvmzwV1s5VFuz+ngFjJKJBOhsOyqEnIzHU+6YuR/KJ56+o/muU+RFmsR5XUzRHmUu5yRvjJhKMZ67CmOAE5BGFao74HngOYSrFWnxb47+XeK9lqdfpOGMkvHipPOjpgChs/RM3cxO9wfeTCfsz13HJ1xN2VJdq6PGzFk8SoYWTzfBdozgsiydLeDGrjngJWG/qk8HIsFPZ3AS53YHwQcmWIyYOEudNQLPjQtcBgn7xilVRM7NIuNvxKg/HWg2xh8ED3PgWb10rp78FFcDHHjSwIcAP8f4Ey1+UgZ4Q6K0uFJDvpwk40BBig1ZPG1s1BQg4VALKGE5x7zY6kjRIR2K8Vw+uDgbnX+4nSKSt8LReGIaKyYkHH1ZRYKfvkPBW3w7HxzkLB6l0wW8cXGJXhzlk+qO2rURRcZ48Wa7lj4/FlpFkzjLeHE0TyBmxxUu1Mq2497uufPosg8OSr5w9c90Xwt72H286/dd8FIZsAWMk19SDR089OWK16n5L1RQBQybgseTNPAkDZMszRMQXzSQQG7YQDwu1u1D7cgdr/v7QoUcyqURAaGhByq2bPw1HCn4MxMBxBcVjhLu8sxd6aI9ygMfSLC/U/AgH+MKaAzAFQUWcqBABX9IXFClizOYIJ9utVvcVRtMgCOCiQe0ORx42MC4o2xkOSdqmtRN3p6Z9tdazkkBWJ55Bcpj8gnndxiAnIeBg4fkjlJUww+pAPh5Qv/yj9SiC4q6aRSAg9mldbwQ/BHGQBXyMiHiiGqqAPiX6fmaMh8cXBHEfP6VnjdjvCrjxelDk8xyjuYWdwqc2MMFDm6y1AcYfMBTZIWFw+A/vfvj98ni6dNVBR+ooPaGTVqYf7FTssGfLOUWfhdz4+Q1x+Ami31Aw0Ww19J0fHL3+uX23jwXWc5lg18SmPmXoTz8z8dTi2dGhwieGXooeRDWjcKhypsSkgU1NavnwBPPFwfe0G43bueLuKIcgmds0TKSLT6wKSFZUFPgmRjPeT4S45nlHE22Ow1oJzIFEOOzUFFUC2xJA0kW+yCwKSGZV1vgqRjw0k5wV2QFnIMm6zV+msiu3VE2prFM06gzulr3AV7uLIKLySAmU88tx3hi/bYK6ozE9kO3cLWOz+pv0vtxyqzjqQGjVEPQGQm8IQ5BCtw4PpOdYKlOTcSLI38B812twxa/vC0jo2iP+6azemgltF/lAAxy2ISBWKtg3rLFw3YwMQC1AFn54B7LdTru6n9ILzcOFO0Z+V7wjDFLu6KdrP2Slxgz/gKBh8li4cJPp1EP9FHh/KIPgocGBe0bJ5NNcbdXJ1u8GC7wsT6UxecWnQQe7CsG8fV3ptvRsPHfXg1z+4K/O0+gY8SWT1y9fNxn6sJZvTzwJYsH5s32676ra5ogWXiShonS/ikA2omWgR3CuinmSZqT/EHry7lFTBg2xCjFRTb1F7hYkizvBAadhSkl0wZG2fpZDuE+wHM9CqdnxMV6LB4mwH2ptTK1stl8MZ4Bj0ya2LeChxLtJhCl150g+EBuMZlGEwPIUlewbx+dZFoFPdT6ahK8MLlzg6ex/zChlyajWT1M5iOzkTbRDGJ038tYDwOeQzDGTd42ZXdcgu4JPLdqM8QogXGxJk2vx1NnDXPD+tAWGuNpSY4Bk1k95/3PUfPgqb3ZzYKtL8kGgke+FzxQgZJZr+G6ada8YwcP8+A/atqpah08tTr0O9PVSzJjjgZYfIK1ijsxg4f87vhyKYaBlp+lFsGjW9PM7gtFexMDMJcwuCYtWrxUK+MW+KaZre5VwOJhsoKfFbI6mkzzReaOcdPizwSvIR6e3aYx3rg9I/hTxqBkdJJJh5LpuAjsRDJgwGSkeDqh9lBoHjzcxIBf0wECsCuHCyVLTLcqfJFgc9nsDBC1YGslOxMV+6CmGgTPndIGnHBYJB3OxHhMYkAlhZnSBHfL6CMLDgNOLJlk1AWGgveOlGS1Ah52A33B9Pqr2W0dGZRrpzz4NbkOeKE85xjB7dWw/bQnuO100xE1Ah7HZ++XvrkgLvxkvTi9rx4lS5FA2DWUjA6S3ldP9+IiGUwopfsAT42ZsVku2ZAYgNbxBLbrO9gZG9cC2H6/xbthC3g0wdZhTxTTPYHnTJpYFwceJge+LcuAl3aiQ48pAx/kANoBqqCHyvbR48d4OO2hhID9hixeKpaDRn5GRHdjmASuBfAgnQN2wBuarYpaAU9kRz7EZajFG9fGxBCakDsw6PDQo8n+FmD8NJn8Xketg0c9AI3LQG9MHS20WVig6zW8DpruRH4GI4FxabpH5MR4dPQV1SR4+Co62DOzQjaLxsVWyL5rxLl6HEcMz1QcemiShoYefGATHgxVx+CRJ4VCbNyQbchPlwcD/nZ7+7m8ymEc7Ssd1n/x3+Oabvcf4X6GIDdB8GIsl7YXUyvgEa7BRUcnZtugyACPCM7YfZM7flJo6E7MwNgGDhh0ePbGtjncUdwfaWoEPPan9BF2lDx6k8FPdgow2amlte47HBM7rXMauPAfDHIgdlyMvr+5juL+SFSL4NHLJ6GVs+F0N0EjjYt5kzW9xdUfZB2QMAUA9/QHBi7Yyw4UlI/5I1FNgjcEPEnGiylk0mRcTGazJ0igmFElNAo1MOwvWKbx4O0fywB4NPBMEEfe2G/xOIjvPmAL4jxrJmTD0A//NeBvduqPDVt2BfSA+dnJupNxyd5g8n3HeNJ4DJ4GTwa8AxAg8pm3/QcEVa5u9ycaEOKYXMsw8igARy8CpMk5b5HjdDl4OqiZ0+lSpJdnbwZ3ORg2aFZvp0+eWb34c2nZvgx0BqABvtxu8saD2C4qg7558NTijXHHxbbTbrNbH2+5V0JmGxeGsVDsTmit5Cf4A03XnYELD2zdIjqBiC4qQL9B8OiBE0zCHQroj4UrNCtLZV5Y29z0BI5xI0icxUs+Zz165wSQccGDo3dcQUQXmW2cRXUyo8vBc/ENvD+AM8SRjIudLJpH2VMpqCThdWcuTU8y2olOS3FgXv9ZpgTDerqIrcKI+Jku2ns5E/314BmRU7bIHM2O38621mTcZbMDoLnpBMIYw0KTAgw1b8YloTLsTsPimEBubthHeH+oPPRtgYfdAE1CsrdlmrZs2ty7nXd7ciN3QnFhd+IvQ3IIuIrliMw+eGwkQBYP+yCJfQb9psDzFsjOphdLd6dy8+8xszdUOEw22KmIdfM7gdw2eduL8yDzFAA7D8eRxLMPoHeT2wVvpH5F3T79s1EfHe8eOTGDxTLJUWXEJHOTCWPMFvZJH6DDi3T7eG2x/5tI57qXGMs2a8y2+DbjCGwdnZkVnbV/Vu9SkSf9yKQjywDnhvHhzeeCUB/gDkly+1E6DD7/S5P7KHc3SbN6+9P6+GG39SlsxpkjPXMn7CrOLODvoZ2wk8cnKLYjHudjujHdgv4oyv4o+PzvzqGhjVMCzzwsa7cB2TobD9goDV9w6BA0odyY6dJYpoHi4KE3YsCumPH7O60c+8Pvss3+0qQIPupbAvAMDb6VwkB04A8InosjZFd22IDC19b6d8LFCuDhoLv52adM97xq0OLxjRi4X1cnvx06WM5ho2Rzu50v4cLQYALYgg5DmgiIMT7QIWLfgemev3tDOhzj8780KRy/x92uHt3G9W0+jHCBMtInZm4Qj7Z4WDiqgt3kOW7beULv4eleoId9um5WL7s8gAB13OLRt9M0441jA0tCBWJjliZm/txwOoB24ltuwrnJ0e/dx/ffttNB9E2B5zwpNChjLHbZl4sF0p+h2ZtkxtxIoYXz7Wd38vQhwA/atOoI+uuWc/YQsKHNB0fusl1m8ruTt/M5rzEbLjnlHTj+ZAteagc8JAtbej4ejlh39IJlHh3dW9Rz+laIJvF0an5GfD1msw9h1D8GGOUyhwPn4lmjNNSkabJ4Cy8pI2Tx/jL2g9wdCf0KFTV/1hXMp/XJrrP21Q3oWa4Mt0h/cs5y7mYVyjtrB7ybh7ucm817W7SP+6JdNset1OMWbwh+tJOQjA9v/WNwKo0Fv99q6Vj8JOrwzwB/wOIXceGP3oGzLeDoJDzVWSeANz7k3OhwmmaMA2pwDjgePK7I6UEX/RngDyznVoHus50Fztwtm9YjG62Xd5JLg7cxMmYn+AfayQCfYwsU3nPnjfEwYQtxboKDXixj14UXadDRGneMrlvm6LaFsT18yEEc/GTdCUyW8jnNZE0aVQEbJZt0gG8MLntvPVHqBP/65RwyYJA8juvk3c7k55vKtwyGghctXthJnLe5hMLxAFouLsnwowqPMFhSqFdv0j5p6C8Hz3vPZfvNBrCAow2Al1x2aNjI+YRgY49MikUGgEcZjOAWuG6bLYBN8pJ3i70evCHOGobhGbuBt627psmDN6Ivj3n5USCZaYHhHb6Tmzw7R3OgESH22mr37q4yeuJODi/n8r80uVqEoQF4vidx+t0uUpd1LNM/XG5sPQQXvUgj5gY1MTvRFqzHxZQB6t4O3rX4KIe/lbcv7aFE8sXBH/jS5Noi2q/bXcjbebqQSQs/WWOGV8jAz8jc3p3WI4Jb6IiGh41aAHPL3QXKY/cV0JcHn/2lya1JFMEw+3XnYszWWc7v4RgvgveTDRTO7ESPBR8YBQ9tHSX4u8tmuzH7SuSbifGrGH+6nJrblu5MVHXAyzYLN5nd6nCywcHBHVWwgbQ1tG54XNjSwLta8dBDO3m5o53Wm5FcRU3vWwFPfu7BnTVKNEOAZgDZiLhk8EubpGSmHahuWIaB4AlNGXyov0BJo3DxNob89eDdvgTR3XlumQMvJGN0IIeYTHeKcCdsC8RYRA/b8dyQKQwUYBOue/qf7WaK3m1Aa+AX1it3X5w1wKBC4A1vsyEvTjfFlSG1AB022gLxw2S6CbsIl+YulzxpwfXgDezX5c747TZK53AZ8Alk151insFm6mZKkoaeVAb8GJG1eNIT6PcQeF9PO2fvcY7WwC+3Ti7nbAwkG2Xx5HfWTslyTiojEEdkt8C0YN2XTO5oT6DfGfCsB7nZY4FC5NsDT0Poctkd3WLDx2fDbWKo4ATvck6MzyHwbIJxWoBey029NNw0CjEe/QR9faPRZEbPFh5B57Src3NEn73hGt8ZsiHwS0nGWpqJBG88v7ORAI8Okg+2xrFZ+sYThn+e2Mt2ntn9JeBhj61blui+npsfRvhqKXbmxSRDY5DRFbgDh6kCgd8SDAseDXjD4MoSX9Lu7luweNQ/66b1rRX2pjo2ShuCQwx8HPgosuB3eVyA1gibdhAIMzPgS4EXfIclTyq6BDziNDd4jejwZJ1k0mIy3Sk3PkcnuwdDG0hjMs5tCHgGIM80ssPtLWstgDfUYuafw0DuP05nY6DNgj/oThEm7fEXoQbSMtajZ8YF7ZzAppQeB9YUQ2dRRYu3fxjr99eT8+YmPslsaLQlm9w4mxPjGWOOGzyoItjA9UD3578JCNwfoU1JXW4vdl0P3sAoZ++WtrfR3uT3ExnQrwbGeEOitBFtNuK++q1pvkEng0fJsDn0LttA56BNwkiJ6PNheZfqReDBn/AQ7POu2220nFFu2VzT5MO+AT/J3IC87ozJjeozMa6e7MS0IMrixRgfb/dUe5zf+92foxz4+bI6nerYeyyWQbleexfulWB+wj8oZTa27nfBeJ28wUzFEUbrxuhQgeSBClFoABqvjxDzAS0nxaDOAj/OG5hDWP6AT0KKH4N0y3OdNfmJ/cVaEuwBMmzEOILKkI5CFDwwbnQIGZhaAxonU+ISyKmc08BPuiGMu1nZJ/+o2xQPOuBoOfCStdJkWx3xMOJOvL/YqpDRCfy5UcXsSjaNbr9vuhQ85rS8m2wEN87Lry8y7qHjZOFnaIYAcTHJCLkhY4tpgQEOYRTy7c0xhtu0/GrgGBFGh2APcddILgE/Nw++sMw6hJh+heV5kRvD5BB9OVcGTA7sRMHbw6Pjyewto3Fkb224hwVHGEX+ZPDG3h+/n4xfb5zfNzGPSUOrW8szEjrwuxjjcW4ytkKFoyqkZKYM5tuy9JASxICf/48hfzZ4s75/1vbV9uzzCJ6Y8H731w2qLA88bGALol5wCHOHRoeTw/ga6P+oMPg9UiRD/OA5FzwJp860zjqBrfuYfoUlCV29dwBItjsNbm5c9+jWzdQKt+A/jDFkEIB85Js0KK6jA0sQzBGd+3yLB3YzbKeUcDJcahtgXaAklEx3tZ0IN5nd6pBhME5FSgj4cqbJ2Iy9974yLYgSlyPs7C+b3BnwxMRomG8J7Bm3n8sGQ9jQKhh/AQvHgwc2ykBrRfloSdC3kAaicWF1Gvgw+TNP4DgWY0/Wjft83giHjjwphUar4GqVqpCTqdcg+LnIjAYEPRhRMF+CGgdPLN66+XGez5vdbphYFwceGiJKRu5E2InuGlcGA37Lt/8j7OPJlyA2R4j8iefqkV/c7gkawXwe9a6BVueQ2H9uBXosHv4ecgtMsuBUOJOWoKWb8XEFyJ4LfvsJ7gUz1IcKr5t1igvNyPdaQQ5mVk+n6rY64oBQY0dnLPODACUMTpsu1CUxfgSXDJD3tMmjY1AMeAPHBSwc/MQWv+7qfzU2zY0cEMEvTh2YKtAXGPZW5ffwEV0B3q7iSAIEz8ysaXncsAE/OVcf841yblYPS2JiEawVNXBr57SRgL8iBiw6H/z2KsapM/hH34VL5vumPYOhgULyw/EWj9tMwUu70kWdQ/Zk8D64Z8f4YbsUN6LXeSCMFDzZCYdQNGxolDbQmMFpQWZWgDwLKRwfC93VQKZklsG8566yxXvonnvP3f6iwul4b75AuophinYiHY4oo00muY8pYOl3WFFoE9peOcbLeM8Ev7+WdAZxS3C30k7YmL2LunTwNAcdYVwyGh1CrZVN3aoB8OCtm9h5Cs7aZiPhGzt8QwMFmRRwrpkqxoCZFtAyXIfvzE6kskOtyZPI97zJ3b6E48wR8kUPlRpg5WgnCJ6WNIo9F/+tbsniAx5EBB96WtbfmsI6d1a//r7efQcSsGFH3A/JTM/wiGCmVosSPtJOvIY4FRFLwiOTPi0r6EHBr/fbggRs2PDk2rqXEL7pRB9R4fpP+D53oKujbJ2WyoGP8eKPAx4dLngZMQ7A476O5+yGmWUbwoOZAiBJ7weJ8r0xswVmZNrfB9Im0W0Um+0LhE+2+Pl4lgQb/UhfYvB0voeKBRHdiSZSPgqemdaRQCG7dxoPjEBWvAmkqpoAv/y8gS0cNLBr3ERKKsM3xyM1ke2MQ2DaIbbcbYgvuap4xIfBR36FChz0ut0apXF7A66ZENk93Ri0LzVHVLgsYScxUESBj4pFcoG5Eod4HfDR36QhfcyBpyCYceFPRjtF9WsueDp/FMdFXKA4JM+hsoyPgk/8qDBjlMC+7e/gZlRmCmDgEUqzrZTlXFRusR10J1qU3bfc59+JUn3HaRY/izMPpi8j7knMFhoaQ6weAAAGP0lEQVRVgV0NaW38+s8pasl3CHzKWiKswzE+9itU68iHK3hhoR5iQ/MlCJ9E8fsLGn8Cfj0oCXyJpX1iT5w8q7/5Y/U6VYs+wZXe++L5YKZUmMzsmhGeE84a5u0kiKFcATz7pcm12TfBVWLjSgDvX6/te+0VxYPHEw867+wa/DSpm7w9DfGcxd/IFuaPlCNM6TLq10Pg6U65MT6qgaG9DiwAKOYC4OcJ/cs/AkWP+zk7LrQG5saSoixe4huK8bAKBjxTdS6bYos6SVXAv3z4M3o5N+tsW5HBr+kR0+WoyV3BAystAuMw+E/v/vh9svgP8R8Vxv0TtdQWFWUr/rV03HRZOgGVUlLNdXyqjk/uXr/c3pvnyI8Kw+nStoWcjY3pn3TvuAIka0XqxeVrZuaYxT8U+Piit7deIdaG9mVE/+R6VWbJEOXFbUrEaTqPegQ/2jW85/rUNeAZL55ZeFAdgh/nF7ChGfKaAMz/IvCwwKiLetnqEvxtd/LMQk5aWIkqvnJCJ40PLa+KL878bc7TyeCNYErJNlbJKEsUW7xp5XoN6JLn46m4KXLRi1Fu9ohpe3bZBcqIK/AuwC+K63D2kwq+DCnyF17ATXualhfjHwG8KNThEeDzCfmfUS8Rn+UyMid39xzjA0q2+Hx5H1WuVutedyNqBTw6/1n1jSGk8PPAJ9z9U13Xg2dmfTG3xSUUjuU9V18VfMqNBtV1OfilqwOXV/NP18TkKx3jj7XmJF0Pnp7MY3byJ2fnq34dHFXRM3jm3gUTca6sEvgTSOBpZP1xFq1zwXPXsBknf1aMPxt8v7N67gQd3VS3fxT8rAvBjwkPuxSU8Hx8LZEzU43oOldf/MxmpK7s/G7Bh56BW1Wzf1JOohR3CN2CF8+VnLbSSamoqeVXaV0f42lCTTUD/uql3eWz+kBCabUC/nJvcvkJHC6hdChEviU5xhe0zf3AegMfp8IrrmNradlLHXloUsFzKnyOpQ74nJbBA+sqxkcqGXzKmf5GwF+thwCfdBEu+UKAkKzgM4uOVIxLPBYPsi/9NXStLV3Ng4/RNeDvWw8B/pjxKXhGl8f48ip3sb9E3ZdJwZ8pBe+Xgq8vBX+mFLxfCr6+mgSvqi8F36kUfKdqErzG+PpS8GdKwful4OtLwZ+pTsBna8jPenHhDdftqh5435jQ3I3nVvCd5lbwneZW8J3mVvCd5lbwneZW8J3mrgRe1boUfKdS8J1KwXcqBd+pFHynUvCdSsF3KgXfqRR8pyoO/uXn2+3z9BHq20/k89NhPd9u09eLM3NPH0DOr/v7ba48M/frl9u7p9y6v8+3zHzOrfutz5N7rTT4H788mZf/eJoAfH+fnPvl79+mbJm5zdSDn7Nzf/08/TyQ+/mnP/NbfiD31OffU3OXBv881fz1849fv80UM/SWLTv3y3/+881s8nK//vY0/ZOZe8qWn9ss9DJzv3z4c8qalrtGjH87hrktvzzl5H4btLm5X3/7423UZ+Z+c5STt83M/fLhfyZXn3/ck63mtnyx+LTcFcC/fvk4+a28Dnj5+a37cnN//zi5u8zcbwFqsvrc3D/PYyb7uOdMubmX4J6Wuzz4H58+Zo/dOX+2v3jL9ppv8bO+fs6v+5Cnm6hle5u3Ifv8128XW/w09I/EugMzhGVu/PGSun/899zr2XV//Wiye2019Wtj/MJ9dvcZ89P1EDJzm2VOfqDu19+/5db99fPicfJyLzPLzNyrxaflLg3+4Ir0LXv+atgcXscfqPst24EzEKuLzj/7kdxyPXPXqRR8p1LwnUrBdyoF36kUfKdS8J1KwXcqBd+pFHynUvCdSsF3KgXfqRR8p1LwnUrBdyoF36kUfKdS8J1KwXcqBd+pFHyn6h78/lj33/7ryd4k3YF6Bz8/1v33b9OTLM/vnqZ/Mp9yvjf1Dn7S+ojx629P9lnlDqTgv07vwZgeOJzAT49Kv8t73vLO1Dv4H58+21cxTOD7sPZJvYOf4vv00OEe45/zntq7N/UOfnpU8m//nB/y/Pff5ll9H55ewe/Kfab+PqXgZ71+6WVSZ6XgO5WC71QKvlMp+E6l4DuVgu9UCr5TKfhOpeA7lYLvVAq+Uyn4TqXgO5WC71QKvlMp+E71/+HL3+OrmZG0AAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-11"/> </p>

<p>Here we have prespecified knots at ages 25, 40, and 60. This produces a spline with six basis functions. (Recall that a cubic spline with three knots has seven degrees of freedom; these degrees of freedom are used up by an intercept, plus six basis functions.)</p>

<p>In order to instead fit a natural spline, we use the <strong>ns()</strong> function. Here we fit a natural spline with four degrees of freedom.</p>

<pre><code class="r">plot(age, wage, col = &quot;darkgrey&quot;)
fit2 = lm(wage ~ ns(age, df = 4), data = Wage)
pred2 = predict(fit2, newdata = list(age = age.grid), se = T)
lines(age.grid, pred2$fit, col = &quot;red&quot;, lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-12"/> </p>

<p>The smoothing splines does not require knot selection, but it does have a smoothing parameter,
which can conveniently be specified via the effective degrees of freedom or <code>df</code>.</p>

<pre><code class="r">fit = smooth.spline(age, wage, df = 16)
lines(fit, col = &quot;red&quot;, lwd = 2)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">fit$df
</code></pre>

<pre><code>## [1] 16
</code></pre>

<p>Or we can use LOO cross-validation to select the smoothing parameter for us automatically:</p>

<pre><code class="r">fit = smooth.spline(age, wage, cv = TRUE)
</code></pre>

<pre><code>## Warning: cross-validation with non-unique &#39;x&#39; values seems doubtful
</code></pre>

<pre><code class="r">lines(fit, col = &quot;purple&quot;, lwd = 2)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">fit$df
</code></pre>

<pre><code>## [1] 6.795
</code></pre>

<pre><code class="r">fit
</code></pre>

<pre><code>## Call:
## smooth.spline(x = age, y = wage, cv = TRUE)
## 
## Smoothing Parameter  spar= 0.6989  lambda= 0.02792 (12 iterations)
## Equivalent Degrees of Freedom (Df): 6.795
## Penalized Criterion: 75216
## PRESS: 1593
</code></pre>

<p>Notice that in the first call to <strong>smooth.spline()</strong>, we specified df=16. The function then determines which value of \( lambda \) leads to 16 degrees of freedom.
 In the second call to smooth.spline(), we select the smoothness level by crossvalidation; this results in a value of \( lambda \) that yields 6.8 degrees of freedom.</p>

<h2>Local Regression</h2>

<pre><code class="r">plot(age, wage, xlim = agelims, cex = 0.5, col = &quot; darkgrey &quot;)
title(&quot; Local Regression &quot;)
fit = loess(wage ~ age, span = 0.2, data = Wage)
fit2 = loess(wage ~ age, span = 0.5, data = Wage)
lines(age.grid, predict(fit, data.frame(age = age.grid)), col = &quot;red &quot;, lwd = 2)
lines(age.grid, predict(fit2, data.frame(age = age.grid)), col = &quot; blue&quot;, lwd = 2)
legend(&quot;topright&quot;, legend = c(&quot;Span =0.2&quot;, &quot;Span =0.5&quot;), col = c(&quot;red&quot;, &quot;blue&quot;), 
    lty = 1, lwd = 2, cex = 0.8)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAk1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OTk5OWU5OY85ZmU5ZrU5j9plAABlADllAGVlOQBlOTllOY9lZjlltf2POQCPOTmPOWWPZgCP29qP2/2pqam1ZgC1Zjm1tWW1/rW1/v3ajzna24/a/rXa/v39tWX924/9/rX9/tr9/v3/AAAT17zaAAAAMXRSTlP//////////////////////////////////////////////////////////////wD/obxc3gAAAAlwSFlzAAALEgAACxIB0t1+/AAAIABJREFUeJztXQl7IzdyXcrenWjWycQaew/JjkUlO0pGR+v//7qwLxLoqoe7G2hWvU8fRTbOxkMdKIDsP3UKkfhT7Q4o6kCJFwolXiiUeKFQ4oVCiRcKJV4olHihUOKFQokXCiVeKJR4oVDihUKJFwolXiiUeKFQ4oVCiRcKJV4olHihUOKFQokXCiVeKJR4oVDiheK6iH/9/Om7M8Pb1x++jf8PPcYPcZir2DlkE3/wZL9iXCvxzydW707/3x9GuX45fb55NIjv/4+vfdb7MesP//r66fv7w80/+7zz9dfPYxXT/0uhu77MD/+Tpjhq40qJfxrk+XbgvSdmlPBP3xnix6x3Y9Y/f+6JH7LO1y9FjSrs+k9vdofrJP718yDdN4+vnweWesEdaF6q+tuxyElwvw1Znw8D8bedeX2uc/zfV3Gu/5T37qRNdmgxrpP4l0EGnw/3L4O+79FTTYi/H23AYAaGMm+jqn80rg9ZBxV/OKv6c/1D3r5QpRtOx9UTfzslzCr/oupPTN4FED+WvfxfED9MBSW+MnhV/3y4O/11/XvLxp+YvL+4BYaq74m3FwiTtej/L1S9Et8CRsE+kbx07l4OVOJ7kT37aZNPNzp3PfHn67OysJTGpX4lvgWciT8v53qKeh5P/05if28TP7pxT9N6/qT65+Xc41RyuN5XOuoAY0V4Wc4p8deAXTroSVDiZ0yO/p0/51VAiT/jZaehmDQo8UKhxAuFEi8USrxQKPFCocQLhRIvFEq8UCjxQqHEC4USLxRKvFAo8UKhxAuFEi8USrxQKPFCocQLhRIvFEq8UOQQf1C0jBWJzyirMLHGSCrxO4ASLxRKvFAo8UKhxAuFEi8USrxQKPFCETCS86/uYTwdxh906H/a49N3JX4POI/kxxJzwuuX7937b4+OOl4+fX8ZftXhpf+Vj3slfg+YR5LwfiH+rwPpr//5dfr1ltvu9d8/j7/f0SuDw93zXff26/wTm89KPMCxqZYCRrL/wY4T2T99O0nz68+99J+UgKkDTly//z4R3wu9Es/huBnzQS0FjuTT3Yny7uWul/Gbx/79f/fEE4l/uvXXKZT43Un8YL5Psj5I/InjXuJn4s85Rhv//nAfUKdU4ttCoFd/N9n418+Hm3/eL4gfvfq3f4y/vnynxO8BwSPZk12mzishfjvNvQqU+ERs56utA43cpWLfvCvxyVDiY+u8DuIFqPrwWP30u81XRTyktybvBdo+j+SPS8wJEbH6Kds1Ed+kYJfo1DyShPcL8eGx+re/fz5cW8i2Qd7LSjxGeKz+pX/SRoFNmunH/5lnq7Vj4/eOwrH6IU8u8VPkdwwWJ3VX4UXRWP3LXZFt2XkWXWZTRHcVYSgaqx8ew5Jv41XiN0CTIVv84GUlvhSaJD65akUwNHInFE0Sr8u59dEi8ercbYAWiWeWc4G/uVALTYb33GjxFzF2J/FNBvQrQN5yTnkfoF69UEgiXmXdQInl3N3TLlS9WncTJZy7pxPr/RGQuKq3h/JuoMRyrt/o0925naHUcm4PEq8wUGA51zP/vAMbrzAhyatXGFDihUKJFwolXiiUeKFQ4oVCiRcKqcSLD98KJV43bIQSL553scSLhxLfceLvUQhH+CGtuQpQ4jmD73EBrORod6EN/0KJ7wIl/oiSEyW+MvtKvB/H8aUsU7Xl/mqJhzLLyBu9ZL0/Hp2lUR1cVe4ObondEw8G/EgHeSRwTJjInFKNBPMKV65bZrXaO3bGHKEdCZPybWbE3ol3MEEyGZLLEN9xV4CsuyWemXTMe4SNbMDeiQ/zlNy6HDt3iRTkMacSr1gRSrxQyCAeas9oGxBUh1W4hWgNAxHEQ3+JuobxQTnkXp49wzaZF0G8SjyFDOIVBEq8UDRMfIyOpMr6yHxwVxsUC2CyorbDosK1LEG7xMd4RdQ9s1yroLBpxFYs9ABhXBf2o5rv1y7xKvGromHiFWtCiRcKJV4olHihUOKFQokXCiVeKJR4oVDihUKJF4ps4vXRJPtELvG7e1ABhw3i5c0dx8gl/hqeNLnBDll7B7BU4juVeAZX+GgSxQD16oVCiReKEs5dr+2piVfim0YB4geHnnmOsRLfMgoQPzycYj9PmlQMyCb+680fv3/TR5PsDvnO3fvD4bZ70eXczqBevVAo8UJRYnfu5nHfsXqRKBGrf3+4U+L3hjK7c0+3SvzOUGh37vnPPynxu0KB3bm7/h/zqEklvmWoVy8USrxQKPFCocQLhRIvFEq8UCjxQqHEC4USLxRKvFAo8UKhxAuFEi8USrxQKPFCocSvjea+ID1CiV8Z7f0kwgglfm20ybsSLxVKvFAo8UKhxAuFEi8USrxQKPFCocQLhRIvFEq8UCjxQqHEC4USLxRKvFAo8XFodJM1Hkp8FFo9VhEPJT4O18K7Ei8VSrxQKPFCocQLhT5pUij0uXNCoU+aFAqVeKHQJ00KhXr1QqHEC0X7yzkaHffEy49mJutDSBNM1qD4vKebsI5awf/mnTu6H+bZIRuTp0zWh5AmmKxBO3KebsI6qm33rbCcK/ykSZX4VdC8xBcEMwmuZpc1GoKWc4zav55zFdG4Eq8+SJNCifeo+tJoYrJdB/F5vpPHuYvrSFxz9VBiOdfAkybzfKdiEh/GaQu8X+OTJiNc+OLtNcFpEMos51p60mTEon2L9lpFoeVcS0+arCnx+0GB5dz+nzSZ6Ajsk/EJ1+HV54EN07oyBQWCG8e1E58WbuU4zZP40nMku74rJz5VKt2l4mstrR3y67ty4lfSxvG1qsQXQIlhP6KE4m03ih0S7zPAISWs7frMtveJHRLvcblDS4AE9/Wr4X2XxDPI4wN69VdDM8WVEJ8FuI6/HsVOocR3EhQ7xb6ILxE4YQ5ioKzRXmRMPyojjPj3h8On//vlsWjVCYgPlR6Pk/e+qIP5EHS+Nj0g1BrzQcS/P9y9fvnOnKfMqToF0RI/Ej/Rz9RRQuLTosK1EUT826/fTsQzW+45Va8Mk1mL+OlyFhP2fGmO1BBESPxzTYnPC46Xs9VBle8BwTb+cIjkvSjxQTunXDI1Doyqp69MXpgV2Z86a4XQyvfi1Qc4XlwydQfhN6zgsXv3K/Q463xrKrjyvRBPES/xHmlViTcwOXfjt2W4r8ukV705EiQNSP81IEzin/pzdc+3cQu61ohP4R0tA4s1UQ2hy7nh9V9RC7rmiI9H3lqiaYQu506vz5/+98vaEh8Tm0msNiYEk2Mb1mqiEAKdu6eThb99+3pfsGoOERITFbglXn1YVeXOaVzfDyOkV81ia4mH/nxidyIE+4gStkFjxOchmjpLFdCAflTTscqBhJG3RRjxzwmrue2JT/j9GpNrg4m8lV9Y/j0Q//bL48vtaTlXtOqiyFPWtPQGpFT2/0OXc+NfyapLIs7Tyyl9NQhbzv32ePp7pV+Izak6F9BJg3nH0PqRSrYncEvbg8n7mUFhNv7E+cvhcFe06kzEL8umV9uHW9p1GJn1uAC7i+ju16uPD8QwQumWfiunx+nfW0Q3zMZ/jfTrQqpeAUgbnzdQlwlWXjgvojlFWVtSCIESf1L0N5FnLesu55hDMliLIyUfob/DfjmrHd4jVP37Q+vreE7qDMozJT6+7aYRSHwfwYn07bKJj1+Vc+txQrlHl1uZUDkmk/t9/LxYe/K0a+Pj43CcZiZKPuJsFSzHZKIdjDnAj+5lRYTb+F1KPJOgEj8g3MZzP2yVU3V5JMTv3AXyAoJtI5D4/jkUvMS39MDBcF/s/NUqxpwYddCqIlZqbU+FQBsPD9u193v1QYupORxDpopnBRexUmtp0c4gQtWzaPCBg0FCybj+ZgLkLMLxaJr3HT+hIp6bEBcPb5MjtW+tGD3lGpoLucTXeEIFMs9zqlPr+hZ1iHgaEThyHy5XuLYrH74wkU18ctXJwCLmWc7BTB5VYLxfrOD5rPA7lUp8HiI868D6gqXcNzuYK1eq6nunrtf2jNu/pXMXJOue0iiB3cc33zvb8LkA0X0qhALEDw7968+xVZcEa7i75aXAqoxX44dU8EEMTwtujwSXWpn5AsS/9t+vWe+Bg0EA6/F4ibeNOJby4Lqj8vJ9WgXZxH+9+eP3XuLpt6tSiI9YFB3dCUd0iSZbv5AUXpoLAjGvqPKgW8WXIpJZ5Dt37w+H2+6lzHIuaI3m2Rvz7K8xIj29RpQ2f1IprAmUHDQGYW5EHPKJT62axcYS7xNHt6xHKJVrlPjUqkMRfldhy+Qj/ADyUoHyRXnCa6qH5okPGyzL6F6u2B+YwafC51EIqBjXqtm1DtRUDc0THzRY1lKb8kuTz6+WRSdZTfvs/o1MT9fiy62NXOLnn8dhgvWFiB/g2w6lIk0lnluJA8NtEW85aYxSiTYXLfCeL/Hjr2UkVB0HzDtJgVndX4mwPHwk8Yx1D9vUvTqJH75Km1R13MynFhZWAoedYcUp94G+OClNrYKj/7VQ0cbHnWijajq8Ws/hV2TpmWQo8VQt5J2yXR01nbs8ifcIVJi8IZFGEo9tvEc5qMSngVlLQ7NJvSmPhfWc07DqMCcBbAJ+E7sh7IT4MKEc31ILi31qygqSVmtNQB0B5qDN0fgQszm7zRzZC/EDoPG07DPN5FAOy7xQIVDi7SPa1MWzJgyjI9BNbsP8Xogng2glWAMe41MHWWagFuzduentchJEuR/oyhrYCfEeVYmCa3Zp8h5m8uUdU5kvZTD53bVWc/F3QjwWDKdQel3uoGSaNaIJdgGIPmyIvRBPAJfaUckh+/FmCdaH40vbNt57G1ujfeKRfS4h8YxXEK4Qwk7g+Dil5mIbNE88ss+MUC7KueqzSKOON466cft1ZoXOtjFU4gcUMMMecWSSuc13ZyY8eZh4P7y9WmiReCh1QafVOHGkr1RaqaWH5RartiXli0zL3nruYiO0SDwnEsiUw3IR+iLRxtutdqAmpJJ8vK89LZokHoIOovUBJXsOUcCoKjp6BXU5DiE562OwukLYFfGco0d08pR8RHyYyUy4leERVG4f0+mMOpigMawP8ctcLzoVmiE+RJOySpdX0/HOHffqPH3NnM9iTIfnJmNOEBVlvhXiofdGNTAjMUykhTp3OJkGcJijV2bWkPNZQfu/DM2YX4kSjwSbKxGdjGUWJMDzWT4jTvuBu7YymiHeAyC/nEgjebOqozYe7qwxuzBuLR7UA6v/9P3qaJj4IBuJTS+thGaCpd2tMkdswgI4YUoAZS2Kdon3GEE7xkLtLJXWsPjOmPAB2mP2f1FkB/ZgwS/PsOTlnDmubMLlny8EM+IDJS9eP3rg5M5mlmsV9YCaDsivXImfASTek8nO+zHhnNUmzWT54+OS2bOXzjDLXEFTrzKaJ94n8SjTJe/Hh0WmqW6PPyIMmSnxTPQPBePtDx92L+qjGeKh2oxWtFZpc6iPwxvINQfSKtqd8/aAwnPf7oHiPkShFeLhFhiTbMks8Z2sTNMIY2Yvgm05iHYm0jV6yvZoUoqbo9L/seyzxwWARwUi0QrxSKyYZF/C5XUcV27w+yYWPhzjINoMog6GUU5qWhgg/vZ8Ed39S7wFqkk9Es/sv3Tj0C5I62fCVGC04t2inL0si2GTCDZDIKXfskVoKNZA88TDXRhGR3RmuQthZgnW0zPKkeBLijBbHTRuacKyRBWXrwHikRk7kmQufAJW8EeTCTOT7VwBQ2FrG+iefVzWfIx5ov23GrLp31zu6xOPzJjnG0oW8cttNEPUeUvARe6g32ZWTvwyrpx5X3BncLq0pD9wiLJRn3h0U4yNNwscOzLstiiZlSOpo/MJbrxBDxCZHCjxzBmRzsP9VUo8BBp8nNxjGj5c4ZFeik6GRAQxBJtwy31ZNEz8CCtkYhn/jlyadLw5bm6R5lcDfNvufkBPLnLybMb9Tohntr3m9MulI6Edmm/mvBwXjcWbfst+WAl0887qjfHK8b8N940R79HljMScP5x1PE2GR2yQ+fbEgz0ncGxHzy3x/GpguT5cAW0RT9fVnMwaVyxZt2KrDBMdKg1E2lOaawKtDKhysEsTtbA6920Rb42P5dUT+2wkn3Ujs6ZHy3y3xDPEYx3gzoQr7+gH8r5bjfts4td70iRS9bYMGQEQqKzZczPd5ZLREOMCUG1sW3ca6mXqRlEepsIFPtahPpf4nOfO4Zs1ktnTTGdMgzJuuDKZqM/FraK75RWsEJieA1UA62CWD+6hmMLFrizxyCU+40mTztMTrKpfUDDb9Tna6YmuMEoXJdtOP+4Bn+CJKXPEm71hYFLvEZdQtCjxnP9F3bqJdnNXGwVM6a6eL9lS9agHU0s0E+P7kSbgfQPMGr9U+DaX+FWeNOmW2f7V3NlY7md33tKuZFSaUydZTTDwJBd19LKJT646cOYz66QfLdqJGDMVQmkNEUSfgiYNMaVLKehy3FckHp+WtWTPpPyyLz4zvtDcfIXIVmPTaybjNYGzIesu0amCBBTiPpv4jOUcxzuYC8OInmk3iYAa2KgQh165gIv5fnmJmnLYkH2X5hTqaKYgzHUUWeDlEl/gMeJglObXmYMz7UwyDKJ4DLAn6oasO1zzQY0Fbw/7FwRGPz5s7pHmdCGXeGY5F/mkSc8uxlLJ88kgtspU6CtNw60wZMuEfakwM6EC1EE6HnY5U52Y1NMSAeqkGYmHcjPO8Il3PjkwIlos2RMLsEcdiWO0xC+zXhb3NSS+1HKOmaPGHZq0k+TOpfDdapr6XNAv5ywB6QjjwwVwEAV7oNKNfTbxyVUvQHmfRndcszG8A0H0hE84I84kkJYczoTF/KI5ey6UwKKmVOprEm+LDbFTx8mYfXx03M2Zw86a3o58uLx6YrJ8S8s6OMVOskL6YUOxGJe3saUqEs+ddrDTDdoZ696RS9BKw6zIN6B2xGeMPXbWmirL90xyFKbIRlSZ+hLvEsrLyh0pWmSAfXtjZtt4Cw9UbrsD1gd6Bc4n6z2YWwzY5ADqF+Vyic9/0iQ2w+YSLmjFxSSjHRRmXjDmAq32OpBpuqOOdpCoei7KY4wHHi6rpktWH/VLdZIt8flPmkSiacbpqBmGQhmky4Ocd6Y9zimgvoEluWRuWZmY4XATv/AZjLwe6gtLfM6TJiGGPs5LOI9geF5xNDagtDuZ60HIjdnvwQQMrMnOO+9ihFSQT3xq1WfwIzqv3DkptwoYKpYu5yxpZXQ5vWTUtJQuRwEs94jHMqu9ZbnztqW3ZH3i2X0UIyrFWFW7+OUtXGQjq8Bd6sw6lpRzWoO2bTcNmTd6kMg8U+6yY+0uWp94znybgTonQ5hZt23l7LNHWhHljq4t+2+VQtE/H9C0P8M8rICraYV469Uy7mRc4XIuyIhD740x3zQ5IkbEddC8a+Re2u+Dpt4SLPWLEvWJp/taE++e9RpjdBkjDteKQEdwKzVQmlvzkd7YFZq3TYln4jvM1qWl0BAmhWlQX3w5h5Eq8ZZx98kbIwYeXU4lEMusszQzeXw6h942vIQkHta3AKG+OYmfMN/PcvcV3vp8Zan5UIQD62G2WpAcVIc1xky162BR+Y8m9dTYt0L8rE/HiA3gkTu0RDSinUoDamYdKHiOtXiQNmb6T94XB63cpn7BfU3iGcGYz9gYyU6V7dOkQZ4XtAQwINjROmBvPBJfbiowNZ23t1ohnhPT/oO1dIehcBSC4QSNaIqYNYFv2nToErjCJKyqBLqO7GyeUYV4Llx14T2KeJMuRuF7lvlwTcDMCJpsdYe07YjceJRAWZyPZ9ktVZR4+8Ns3s0r5EOVZBizQ2rB59UjFWEl+y5FwLSfZ9SU+OnDJMAXt46TOisrUPWMFwbX4Jb40wSzPZiVrhhxEx1/F77BgZeiQDa7uhYkfhoH47woZ2fNrFDVM16YJxMMCAa0zUV5PIE9UpNvcPClOFy06Yw6xFvoO2QfqmOoownWfUDt6VaxkHLYHrIHvq6hRmOQQz85tFif+KNl3qdLXYp+w86d8Z5zrVB7aO2eqY3hLHWXKLsA2I54LBLDlgLRydg5Mq8jebMDvu6acAfddbgFG1ceBLtRpJLc5VzYjHgmbjYlTLwTS2nOc2aTw0qmr5R4z/ChAF3gXbhH3FMtKnD5lFbOgZoSP75Oh8LdJpTdy3JWO71amzHGFat0RxKY0Yu28TCZu43g675c7Uk8DYb0r/OXAaibxezOcTyhVbSVy3gPl2IeM8PE/ay5RfWPud7ERoPMzBiwzkYYNiZ+OQxn886sxK2B68h7ZjHFcBNCvM/MGH3mQgXsjS0mLt7iOfK3FwiG98A6NiOe04XjQREgez5V6Va0PucuVU17MnE37JR47lIW2pN4MttH3jlJo+XgvitsIj4wxhQ4kkyoJtzBCDZLEB+KihI/H/+HokTLjW8tTvNE2sjERe6otIZIvD2RwtmMWbUtCsZjO4lfmu/5K56MKnAHtRb+EClNOUCvTKvMMspTB3KwcDK+s9gCZv8jsTHxF+G6fLUX2merOKmJJvj0RZBSia8DWx5nMsSVSfxCDIyvdBOyuUU7XPUA8bYumXV41AIttvxg3gXtzm6wHfEjplGyeCfqnUod9tXc5RhNkSrxRmdt+oN2W5qbHVsTPwLuxRlDeaSXLEypcGeNIsSEcgqBRv9MiQ8KwZTdYCmBjVX9+LrgfelawS1zqzq6H+8zwDDZbb5Zd5+vg1vUMeqrawCbEW+Hack4cMHabplg1WcG9pgIHGUCJke7+9iZ4K6QKdvELNhe4sdfNiG5kW6FCjpCZjuUFZcz2/ZIPG2I6SDKWs0GbEf8BOP8l4cbeIkZyiAXL3WII8rFN3H9Ej/CMO+2LsSCveSUywT2Yqw6NhAurgnUaGVLvy3xH/PJ+e7yyuhTJK2e05TTBcYbTJV4n5oOKsA3W9vP35T4C+9umWUcrG7JJuc70TmSB7djhqnzGH/39Y2woXP38fGj/SsXnfnB7WAFeW9wBzQMgQLsbwK77at6C3HYjHibdyTSbmPss9XIBQhCULkwbwG57RFdW90SbCfxH5ZfZ8Aj8SgrkwArD4Ina1AHPdVKlHh6pB8DKnyUl9nJnusIl01fn2LyFmp0RWxJ/DKD20biHTKalyr5Izd7UOkglJgjjC2qNQu2s/FEKLljtB29EqH9mQGN0N/0Ok5Al9y6ilVMlZjPJj74KVRUKOlJ1zkn8P0YoOSY8y8RpT0RJpwc5J1siVziY59Jw4gHCoXbucKTrUxB41pa4mnyFoId10Iu8QUeKhxr8WrHvM5I9e3XQeSw1Jd4K7Wx0yzO3jYzASdsK/GRT6HynX8pEWj1IKIFxnzXdMiLtrfdci7CVq+pQ7nFlMfGG69rSfn2Jm4F4vknTXo85MTIZsJo0MVURNdW431zE1fCueu1PTXxvMTDK6k6NNFttxKCuhbk4adie2+hAPGDQ//6c2zVZRCzUE8c3SC1sDsUIP71y/fY5dzWspJnn5H70VA4Jh7ZxH+9+eP3XuK/RDxUuJKseBR+WBVOV2RHSiDfuXt/ONx2L3EPFYbWvQpSt2pES3xs1YzCTPwxkNQxhnTVXKJvj42J53Zc034MpPhBm9QF5U5RJ4BTYiFXUOKz+rFTbEZ83pJqOzTfwULYWOIDjySHoGYMzVtJYRRYjyxRx7njrkfeQ82oubeKwl0L8ksisTXxENER0bzBXVWjq8TnYFXPWoDb7kEzxK+6B+JpTpY/P6IV4muKoLAV/IhWiK863ptJfEOTqgHig7bOiodraqAldVKf+KDIzqrfhNwODXWmPvERO+oJWHVNWKIHtVA/gNOKW7ffJpKw9e6c+/euNodKPMAWxCtqoKaq1zlQERWdu1atnww0I/GbTYKYhq54ZlY5ehWTUBrrfk1nP6i/nPMllEYrEl95TjUQwJGJ2tpEBvEtHtpQifeg+lkoh1+yYzRPfAOnH2v7o6ugeeLX3cPJwp553wHxIcgUvl0zmIjrID6Xd4HMXwnxeRDIuxIvFUq8UCjxQqHEC4USLxRKvFAo8UKhxAuFEi8USrxQKPFCocQLxZrEK1rGesS75oSWbry0Ei+0tBIvtLQSL7S0Ei+0tBIvtLQSL7T0SsQrWocSLxRKvFAo8UKhxAuFEi8USrxQKPFCocQLhRIvFMWJf/18ONz3D6E+fCKPn/bj5XDon16cWLp/AHJ628+HofHE0u8Ph5vH1LafhyMz96ltn8Y8etRKE//2y2P3+tfHnoDn2+jSrz9964sllu76EbxPLv10379mlH759D295xml+zF/ji1dmviXvuWn+7dfvw0sJuBULLn063/87SQ2aaXff3vs/yWW7oull+5G9hJLv3753heNK72GjT/dw9CXXx5TSp8mbWrp99/+OM36xNInRdlr28TSr1/+q1f16ffdy2pqz0eJjyu9AvHvD3e93kobgNfPp+FLLf1816u7xNInA9VLfWrpz8OcSb7voVBq6dG4x5UuT/zb17vkuTuUT9YXp2Lv6RI/4Ok+ve0sTdezlqxtTlP25YdvlSW+n/o5ti7DQxh947sqbb/9Yxj15Laf7rrkUZtEva6NH3kf1H2CfzrdQmLpbvTJM9p+//1battP96PGSSs9epaJpSeJjytdmvjMFempePpquMtex2e0fSqWEYGYVHR69CO65xq5EwolXiiUeKFQ4oVCiRcKJV4olHihUOKFQokXCiVeKJR4oVDihUKJFwolXiiUeKFQ4oVCiRcKJV4olHihUOKFQokXCiVeKMQTf/la91/+/jgfkhYA6cQPX+v+6Vv/TZaXm8f+X+K3nPcG6cT3mL5i/P7b4/xdZQFQ4p/638Hov3DYE99/Vfom7fuWO4N04t++3s8/xdATL0Pae0gnvrfv/ZcOLzb+Je1be3uDdOL7r0r+5W/Dlzz/7bfBq5eh6ZX4C1K/U79PKPED3h+kOHUzlHihUOKFQokXCiVeKJR4oVCo3QsZAAAAKUlEQVTihUKJFwolXiiUeKFQ4oVCiRcKJV4olHihUOKFQokXCiVeKP4fPy7px2j8Ra0AAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-15"/> </p>

<p>Here we have performed local linear regression using spans of 0.2 and 0.5: that is, each neighborhood consists of 20% or 50% of the observations.
 The larger the span, the smoother the fit. The locfit library can also be used
for fitting local regression models in R.</p>

<h2>Generalized Additive Models</h2>

<p>gam1=lm(wage~ns(year ,4)+ns(age ,5) +education ,data=Wage)</p>

<p>So far we have focused on fitting models with mostly single nonlinear terms.
The <code>gam</code> package makes it easier to work with multiple nonlinear terms. In addition
it knows how to plot these functions and their standard errors.</p>

<p>The <strong>s()</strong> function, which is part of the gam library, is used to indicate that we would like to use a *<strong><em>smoothing spline</em></strong>*. We specify that the function of year should have 4 degrees of freedom, and that the function of age will have 5 degrees of freedom.</p>

<pre><code class="r">require(gam)
</code></pre>

<pre><code>## Loading required package: gam
</code></pre>

<pre><code>## Warning: package &#39;gam&#39; was built under R version 3.0.3
</code></pre>

<pre><code>## Loaded gam 1.09
</code></pre>

<pre><code class="r">gam1 = gam(wage ~ s(age, df = 4) + s(year, df = 4) + education, data = Wage)
par(mfrow = c(1, 3))
plot(gam1, se = T)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAA4VBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OTk5OWU5OY85ZmU5ZrU5j485j7U5j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVlZrVlj9pltdpltf2POQCPOTmPOWWPZgCPZjmPZmWPZo+PjzmPj2WPj7WPj9qPtY+Ptf2P29qP2/21ZgC1Zjm1ZmW1jzm1j4+1tWW124+129q1/rW1/tq1/v3ajznaj2Xaj4/atWXa24/a29ra/rXa/tra/v39tWX9tY/924/9/rX9/tr9/v2QGO0YAAAAS3RSTlP//////////////////////////////////////////////////////////////////////////////////////////////////wDLGfCsAAAACXBIWXMAAAsSAAALEgHS3X78AAAZx0lEQVR4nO2dDX8bN3LGby03tc5xEl/ppOcmSmm7V1+bNpSUNE3F3PUSsXz5/h+oiyUp7nJ3sAB2gBmAz/OLI2mxA2CAP8EBsC+/20FQQfqddAUgiFMAGipKABoqSgAaKkoAGipKABoqSgAaKkoAGipKABoqSgAaKkoAGipKABoqSgAaKkoAGipKABoqSgAaKkoAGipKABoqSgAaKkoAGipKABoqSgD6krW5af+1mpt/mzfV1UP917KqXpzS1t9asllVzxZNdgfTrp4yWs1Ws0H79XU13//y+wVdljm8qjq1GhCAvmCtrztw7IFezneGu1WdtJyvXl39uarm6+vnNqD/1pia82vT9fWzxS9fP/u3qvmtLuR1ndD8boA2Pzdvnn093yeeCm60/GZWV+r5H2e75au62F8+rcznqzl3XwVz5u38KZO6ej81aae8APQl62mEXlaz/fBXHUn7pUGkGVJXs7sFMbYetNoPzI3p3WL9ejlbvdjcmN8aymuZ3w3QTep8+26+TzyWvgdy++Hnt491WX94+9uHh7rY+gNV/1u/Nufuq2CAXn/7lEl9aJ92ygtAX7IOQDc4H0dow+XMAL19V5kYoY4H/uHDgzXk2A/Dzc/r+tzNzS81fZub2yY8aIDemqMGaHPs/qE+eNuJHfYVMZ+ofzZl3f98Uxc7+2VR/1p/VOpz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" alt="plot of chunk unnamed-chunk-16"/> </p>

<pre><code class="r">gam2 = gam(I(wage &gt; 250) ~ s(age, df = 4) + s(year, df = 4) + education, data = Wage, 
    family = binomial)
plot(gam2)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAA4VBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OTk5OWU5OY85ZmU5ZrU5j485j7U5j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVlZrVlj9pltdpltf2POQCPOTmPOWWPZgCPZjmPZmWPZo+PjzmPj2WPj7WPj9qPtY+Ptf2P29qP2/21ZgC1Zjm1ZmW1jzm1j4+1tWW124+129q1/rW1/tq1/v3ajznaj2Xaj4/atWXa24/a29ra/rXa/tra/v39tWX9tY/924/9/rX9/tr9/v2QGO0YAAAAS3RSTlP//////////////////////////////////////////////////////////////////////////////////////////////////wDLGfCsAAAACXBIWXMAAAsSAAALEgHS3X78AAAVd0lEQVR4nO2dDXvbthVGCzvr7LZZ505uVi9xxyTr0i3bJLtb11nZ1taaKP7/HzSAlCxRIkh8XACX4HueppYN3osPHkEgRVEfVQBkxEepGwAAJRAaZAWEBlkBoUFWQGiQFRAaZAWEBlkBoUFWQGiQFRAaZAWEBlkBoUFWQGiQFRAaZAWEBlkBoUFWQGiQFRAaZAWEBlkBoUFWQGiQFRB6ypS3h7+tCvWvvBbnD/K3pRAX+7L11z1pVuJsXqfbhrZ5SrSarWad8etLUTQPPpnr61J/XolWqzqA0BNmfdmSoxF6WVTKu5UsWhar5+ffClGsL5/1Cf1jHaq2l6Hry7P5h5dnfxL1I1nJlSyoHyuh1c/y+uxl0RTuK65ZvprJRj37alYtn8tqP3wm1POr3rZpgtpyUTwlkc37vi7b54LQU+Zphl6KWTP9iZ1pH2pF6il1Nbuba+bWLatmYq5D7+brq+VsdVHeqke15RL1WAldlxab10VTuKu9EXLz9oebR1nXFzc/v32Q1conlPy3vlLbNk1QQq+/fkoi/9SU7XNB6CmzFbrWeTdDKy9nSujNa6HWCHI98Ju3D71LjmYarn9eym3L2w/SvvJ2US8PaqE36q9KaPW3+wf5x0Vr7dA0RD2jfq/quv/hVlY7+zCXD+VTRW77y6YJjdBPSWTz1OPDXBB6yhzN0LXQ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" alt="plot of chunk unnamed-chunk-16"/> </p>

<pre><code class="r">
plot(gam1, se = TRUE, col = &quot;blue&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAA5FBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OTk5OWU5OY85ZmU5ZrU5j485j7U5j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVlZrVlj9pltdpltf2POQCPOTmPOWWPZgCPZjmPZmWPZo+PjzmPj2WPj7WPj9qPtY+Ptf2P29qP2/21ZgC1Zjm1ZmW1jzm1j4+1tWW124+129q1/rW1/tq1/v3ajznaj2Xaj4/atWXa24/a29ra/rXa/tra/v39tWX9tY/924/9/rX9/tr9/v2qsPpHAAAATHRSTlP///////////////////////////////////////////////////////////////////////////////////////////////////8Ano3kzAAAAAlwSFlzAAALEgAACxIB0t1+/AAAGhhJREFUeJztnQ173DZ2hZeW3NRax0m0HSVd11Z2bHfrbbObkZQ0TTXej0TTmeH//z8lyPkgh7wgAAK4F5hznjiSBrwgLvEOeEiC5G9KCMpIv+FuAAT5FICGshKAhrISgIayEoCGshKAhrISgIayEoCGshKAhrISgIayEoCGshKAhrISgIayEoCGshKAhrISgIayEoCGshKAhrISgIayEoCGshKAhrISgD5nbW7bf63m6t/mprh4rP5aFsWLY9n6W001q+LZoq5uF9rVoaLVbDUbjF9fFfPml98u6HWpj1dFp1UDAtBnrPVVB44G6OW8VNytqqLlfPXq4k9FMV9fPdcB/Y86VC1fha6vni0+vXn2n0X9W7WS66qg/l0BrX5ubp69mTeFxxXXWr6dVY16/vtZuXxVrfbT54X6ftXLNk1QS97ND5VUzfupLjvWBaDPWYcRelnMmuGv2JP2qUakHlJXs/sFMbbutGoG5jr0frG+Xs5WLza36rea8krqdwV0XTrfvps3hfu1N0BuP/z8+qla1+9e//rhsVpt9YWq/q2v1bJNExTQ628PlVQfNWXHugD0OWsHdI3zfoRWXM4U0Nt3hfIIlR/4lw+PWsvRDMP1z6tq2c3tp4q+ze1dbQ9qoLfqUwW0+uzhsfrwruMdmoaob9Qf1Loefr6tVjv7tKh+rb4q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" alt="plot of chunk unnamed-chunk-16"/> </p>

<pre><code class="r">plot.gam(gam1, se = TRUE, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAA5FBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OTk5OWU5OY85ZmU5ZrU5j485j7U5j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVlZrVlj9pltdpltf2POQCPOTmPOWWPZgCPZjmPZmWPZo+PjzmPj2WPj7WPj9qPtY+Ptf2P29qP2/21ZgC1Zjm1ZmW1jzm1j4+1tWW124+129q1/rW1/tq1/v3ajznaj2Xaj4/atWXa24/a29ra/rXa/tra/v39tWX9tY/924/9/rX9/tr9/v3/AACrUApQAAAATHRSTlP//////////////////////////////////////////////////////////////////////////////////////////////////wD/IKv2MwAAAAlwSFlzAAALEgAACxIB0t1+/AAAGgtJREFUeJztnQ2b2zZ2hZceN/Ws4ySz1SS7rj1Z2e7W26aNNJNsmorej2RUSZz//38KkPogRQIEQAD3AjrniTMzAi+IS7wCD0mQ/E0FQRnpN9QNgCCfAtBQVgLQUFYC0FBWAtBQVgLQUFYC0FBWAtBQVgLQUFYC0FBWAtBQVgLQUFYC0FBWAtBQVgLQUFYC0FBWAtBQVgLQUFYC0FBWAtBQVgLQUFYC0Jes7V37r/Vc/tveFlcr8VdZFC9OZZtvNdWsi2eLurp9aFfHitaz9WwwfnNdzJtffrtQr0t+vC46rRoQgL5gba47cDRAl/NKcrcWReV8/erqz0Ux31w/1wH9jzpULi9CN9fPFp/ePPuPov5NrORGFNS/S6Dlz+3tszfzpvC04lrl25lo1PM/zKrylVjtp88L+f2ql22aIJdczo+ViOb9VJed6gLQl6zjCF0Ws2b4Kw6kfaoRqYfU9ex+oRhb91o3A3Mder/Y3JSz9YvtnfytplxI/i6Brkvnu3fzpvCw9gbI3YefXz+Kdf3u9a8fVmK14gsl/m1u5LJNEyTQm2+PlYiPmrJTXQD6krUHusb5MEJLLmcS6N27QnoE4Qf+5cNKazmaYbj+eS2W3d59EvRt75a1PaiB3slPJdDys4eV+HDZ8Q5NQ+Q36o9yXQ8/34nVzj4txK/iqyKW/eem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" alt="plot of chunk unnamed-chunk-16"/> </p>

<p>In these plots, the function of year looks rather linear. We can perform a series of <strong>ANOVA</strong> tests in order to determine which of these three models is best: a GAM that excludes year (M1), a GAM that uses a linear function of year (M2), or a GAM that uses a spline function of year (M3).</p>

<pre><code class="r">gam.m1 = gam(wage ~ s(age, 5) + education, data = Wage)
gam.m2 = gam(wage ~ year + s(age, 5) + education, data = Wage)
gam.m3 = gam(wage ~ s(year, 4) + s(age, 5) + education, data = Wage)
anova(gam.m1, gam.m2, gam.m3, test = &quot;F&quot;)
</code></pre>

<pre><code>## Analysis of Deviance Table
## 
## Model 1: wage ~ s(age, 5) + education
## Model 2: wage ~ year + s(age, 5) + education
## Model 3: wage ~ s(year, 4) + s(age, 5) + education
##   Resid. Df Resid. Dev Df Deviance    F  Pr(&gt;F)    
## 1      2990    3711731                             
## 2      2989    3693842  1    17889 14.5 0.00014 ***
## 3      2986    3689770  3     4071  1.1 0.34857    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<p>We find that there is compelling evidence that a GAM with a linear function of year is better than a GAM that does not include year at all (p-value=0.00014). However, there is no evidence that a non-linear function
of year is needed (p-value=0.349). In other words, based on the results of this ANOVA, M2 is preferred.</p>

<p>We can also use local regression fits as building blocks in a GAM, using the lo() function.</p>

<pre><code class="r">gam.lo = gam(wage ~ s(year, df = 4) + lo(age, span = 0.7) + education, data = Wage)
plot.gam(gam.lo, se = TRUE, col = &quot;green &quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAilBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrUA/wA5AAA5ADk5AGU5OWU5OY85ZrU5j7U5j9plAABlADllAGVlOQBlOY9lZmVlZrVltf2POQCPOTmPOWWPZgCP27WP29qP2/21ZgC1Zjm1ZmW1/rW1/v3ajzna24/a/rXa/v39tWX924/9/rX9/tr9/v1myJcVAAAALnRSTlP///////////////////////////////////////////////////////////8Ago9zVQAAAAlwSFlzAAALEgAACxIB0t1+/AAAD09JREFUeJztnYl22zgSRZtJjx1Pd6atLD1yZrFmJspYC///95qklpYtSCoABaCA9+5xDk8sYxEuq0BSpPBTTyD5qXQHSBkoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB6UGPEdsUxC8RFlSWooHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAovmGuGaD4drkqgOJBofhGuTX6FN8mNwc/Wvz6Yb596rq7F/+2SUFixW+f5v1iPvj/eGae4i0TK37z+fv22/O0PVYpu52PJEMy8tGpfgj31WPfr+6DmicJEA18/MHdYoruc+8Ubxoe1TeGdNQpvi3Eg07xoFA8KBTfED4jTvHt4DXgFA8KxTeC72hTfBt4DzbFg0LxoFB8A4SMNMXXT9BAUzwoFF85oaNM8XUTPMgUDwrFg0Lx9RJ1OyvFg0LxoFB8pcSOLsXXSfTgUjwoFA8KxdeHylOJFA8KxYNC8ZWhNaoUXxdqg0rxoFB8RWiOKMXXg+qAUjwoFA8KxVeC9mhSfB2oDybFg0LxFZBiJCleTqk3lKRdihfS7f4180WtFC/j9M3klJ+sLYoPI4f8pG1QfDijmCTHXTmmFIoXcO2dKEvKNo1Q/G0kbyRWWJYof9Xg9Zcp3oNQcUXOFHTEr3/5fv5LOPEjPvN+9ih/1fj1l28vTTLbr0Py/kx9G+IDv1joltDi1wOiI34zG5S/ivim1qSJehLZUbholJ+ikOo3s7sfTPUXOJVsQvgBlTl+/XCe6Cn+iJkoP4VH9Veo/x1chuIvU/0buAbFg0LxoFD8JSrv/i0o/gJ19/42FA8KxYNC8S4q7roUindQb8/lUDwoFA8Kxb+l0m77QvFvqLPX/lA8KBQPCsWfUmGXQ6H4E+rrcTgUDwrFg0LxByrrrogPl1+i+D119VbEhyveKb5Zrmqn+Ga5rp3id1TUVRk3wr2n+Il6eirjtnaKbxGBdopvD0m49xRfTTeFCLVTfCW9lCLVTvFNIQ73nuIbwkc7uvgKuijGSzu4ePs9FOMX7j24+Gbw1k7xTeCvHVq89f5JCQj3Hlm88e5JCdOOLL4NArVTfN2EhnsPK95y38REaEcVb7hrcmK0o4pvgKhw7ym+UmK1Q4q32i8PorUjijfaLQ/iw71HFF87KtoVxK8funfPfb/53OjSJNbQ0R4vfvs0H/491iLeYp98UAr3Pl78Tvji/kS84TVpDHbJBz3tOhE/sPz5fFUac6Mc16EPmsMe1gPNyqLn+M3scdws7S8/Fum9n9yXk6/cNI/qZRxHvZB89UZRxEd25vWw55ev3xyIeFXvu19ltJ+iIRDxcVwc9yzy0zQBID76vPL6wCeVn65yAPGxCEZePe9/2KNZ52taFx/fCfHgq4hKLvxA4+Izet/9dai09CH+hsbFRxNgws9fbuEHWhav0IFQIbdlZg/xNzQsvqD3fWmn18LCDzQsPh4FO386Lh3ib2hUvMpnwlqOTAk/0Kh4Dayp0qVF8ToNt+29RfH0LqFB8Sq07r058UqNNu+9NfH0LqUx8ToAeG9JvNr93AjeheJX033yc9WqzQLhXSR+1d2Pm+2Tn/qs4vUaw/AuEb/5+nL473/Pbp4Pr1oVeveloTleBRTvcvHr82ek4qrWQ7EhGO+iVD/bPwR5/pRUTNVq0HsIkojfzAblhiNeC3MfnaZEluo3s7sfJsVrPouNpF0+x68fPBN9dRGP5b3qo3rVBsC81yye3mOoWLwmcN6rFa9bOZ73WsXTeywy8cNJ/PJRuWo7IHqvUbz296hBeq9RvDKY3ike1Du8eFTvlYlX/5pUWO+1ns4pgesdWzywd9GNGOffSK5RdfH6oL3LxP8vSL2yKHpXRZLqF7ZvvQoE27tsjg9L9rbFg3tXWZPmQjZQFK+/2gW69+i7bPcrVPSru5e3L1mOeHjvwohfjFdvlveOPzjMAnWsSXOA3n3meOdMnyHi9XcgFO/XYk8kflxfbIj4c7f9cSJIN8fTexg3xk2W6rdPg1tXpo+ouhj0Lni99CXbBDsPgHfJ4ZVt8fTujfSY2rZ4fdr27jHkYOLpXfi3JcUzz/vge9nEQ/xw4uZ1YB8pLsFpXKveQ66VGY54bRrVHjjMRj+dY7hLCR0p2ZW7b8/6VScqeoF47dYSWB/3oaUs4i9elo2oOicK4T6+G0ufO8X2BWKO18zyJuSnvzZWQrz6vfPqs3tp+Rkuhu/FLzOmeovPTDj6VEq+VruyOf7T8+refSNGeNV5UAn3S+8kt3zN9qSnc7sfzarVylwj/TlcNvl571Y/ns4NP75fcah/OcmXpOF++icZ5Gd+POXPhyZXXef52GTxVK8S7tJ3kVJ+iroNHtUrUWKF5gRhmWqHMiRe9x2WukKrIarbC08ZOuJ77u7+/8nzuq3u54R+KIV76Blp4HFtlzDCHc1d43iX7frji+MO6piqU6IU7lEfM0lvgcoQ3c52r798PJ0bxKc8nbMY7vFclJ85ui904RqnEe++rz646sA/vY0V7TtO5ZaKbhce99V7ei/09tTCXfMqWeHodmHoqF4FtXA35kkdA+IVh9jM7G4f4Y0Yvo9PCar2/DMJ1C5HGPGrrnvne/tV7mSpGO6t5/neJ9WPB3jqS4zaDHcA71Lx64cx4v3O5CUfa3lUdx3O7p4I53jfUzlB1aow3H0RiN/8/fhfo4sKa4Y7iHdRxCdaRlxtiJnlA5DN8avpZksv7Ter1vLO2T0IAxdw4lDVjpLn+2LibYY7kHfpffV3L0vNVK/mXakeQKT31Q8/Ge6y9YOzewTSGzGGmLcmXlk7Up7v5Y9QvXteKR/VR6Id7mDeqz2qZ5aPpE7xnN2jqVK8/nPP2hXap0LxCZ53166wAqLF7z6wdX1im2g4meVViBU/fl/9+K3m2cQz3HWIFb8TvrjPJZ7eldCI+IHlz+dXd1IMKfO8FtFz/GY2PTa/fJ9jTRp6V6Oqo3rmeT1qEk/viuiIdy4urz2szPOa1COe3lWpRjzzvC61zPH0rkwl4pnntalDPL2rU4V4be/Wvp2iBDWIZ7wnoALx9J4CPPFM8xP2xdN7EsyLZ6JPg3Xx9J4I4+KZ51NhWzy9J8O0eOb5dFgWr/vsO8P9FYbFM95TYle86rqginU1glnx9J4Wq+KZ5xNjVLzi9xEz3J3YFM94T45J8VxmIj0WxdN7BgyKZ57PgT3xBleRahFz4uk9D9bEM89nwph4pbWAGe43sSWe8Z4NU+JVvDPaRVgST+8ZMSSeeT4ndsQreOdBnRwz4hnvebEiPt47o90LI+LpPTc2xDPPZ8eE+GjvDHdvmhBP7/5YEM9EXwAD4uO889w9jPLiGe9F0BHvXItQJj7KO6M9mOgVKmb7L6d/H7ZQAb0XQmGhgkF5cMQzz5dCIdVvZnc/AsVHeOdBXRwqc/z64TTRy5cmYbyXo+RRfbh3Rns0BcXTe0nKLVTAPF+UYuKDvTPcVSglnt4LU2iOZ54vTRnx9F6c8h/SFK8Tk7rE07sadYknalA8KBWJ546kCcWDUpF4ognFg1KLeO5FylQint61qUQ80YbiQalCPHchfWoQT+8JqEE8SQDFg2JfPPefJJgXT+9pMC+epIHiQbEtnvtOMkyLp/d0mBZP0kHxoBgWzx0nJXbF03tS7IonSaF4UKyK516TGKPi6T01RsWT1FA8KBbFc4/JAMWDYlE8yQDFg2JOPHeXPFgTT++ZsCaeZILiQYkWv36Yb5+67u7Ft+qA3hA9YsVvn+b9Yj74/3hm3t8ivecjVvzm8/ftt+dp61k1KUp0qh/CffXY96t736pJUeIP7hbT+jMn3uVr0nh1hahi56ie3rNiRzzJSrGlSUhZjIjnTpIbG+LpPTuc40GheFAsiOceUgAD4um9BAbEkxJQPCjFxXP3KENp8fReiNLiSSEoHpSi4rlrlIPiQWGqB4XiQSknnvtFUYqJp/eyMNWDQvGgFBLPnaI0ZcTTe3GY6kGheFDyie8uIamKZbXLUjxoWYoHLUvxoGUpHrQsxYOWpXjQshQPWpbiQctSPGhZigctm1I8sUw68df2CZY1XpbiQctSPGhZigctS/GgZSketCzFg5ZNJJ5Yh+JBoXhQKB4UigeF4kGheFAoHhSKB4XiQdETv37ounnfb2bT+sP7zarr3p8tTSosu1vXNqzsshM17Cy7ferePYe1u5xufbndaWe7wy+Dx0pY9gQ18ZtPz/36r8+jq+V9v9+sf/k+boLK9qO+22PoLrsQ7DFXyq4ca2cL+xxcdvzlMrTsbC4pe4qa+Gnt2cV8XHt40L3fjC/sNwFl179+ue3PWXZaBjmwz47Vkz36PIkJKjsu1y1o+3JZQcMnqM7xQ9v7Lpz0RBDx7rLbb/+WpHpX2SEBSjKus+z64z9Fqd7ZZ/HbdfRZFvEX+lxU/PbpcUp0Qxf2m3HykQ2io+zyUTTHu8oOubCXRb2j7MO8HwcyqM/i4XeUPR7a+JedUr1wb92jKH4ze+z7811QNBSOssNGJv5Cu6J53t1ucJ9FM/yldoeddSU5QnO1Oxzc/Sab3g5oHtWPA30+x0sEuMrujpBdK1ymbXfzVSbe3e7idocvlD0mjaB2e8nxwSlq4nf9mdLQdLQ5bYRvxlm2l53OXWx3+4+bA+FudyFK9e6ysvnFWVYY8c6y08woPLjYoyb+cAp7dj4tmHrcZWXi9dsdNoKMe6GsaIp3l11F9Hko63c2xyt3qFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCjg4nf30O9vqN49gLz+9YvnE8dVAi5+9Tj+LI5PJYxPnj7InrasHHDxm68v/5meU90/gDRsBI91twC4+O23f319mR6qHh9iWYxfo0HxECx/fzxG+2w+pXqKR2B8VHGc41d3L6Px4b8UD8H0TO2Q68dMv+y6v3yZUzwE67+V7kEhwMV7fn9IQ4CLx4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgelD8A3p4AguZ6PB8AAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-18"/> <img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-18"/> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAkFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlOTllOY9lZmVlj49ltdpltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP2/21ZgC124+1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v0Pm8E7AAAAMHRSTlP//////////////////////////////////////////////////////////////wBipdB4AAAACXBIWXMAAAsSAAALEgHS3X78AAAM8ElEQVR4nO2dC3ujuBlGl2Q3zUyaOpPpLUm3W7sNOxvf/v+/q4QA48QmCIEFes95MpMYY/Ghg5CEQfppD5L8FDsAiAPiRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFH6it/cvZ5ZZv/fPmTZdbnCOsuy2w/r7p6fem65O+tDEPujkNo+kd28Va/MnpzazVDy7Ciub0v3R8cccattvphEspAs7Cl+fSoTa/HbBxNS7nJwbVbcPS/er3sB8TacvDrkmiGdJbc7tapXGkn86mjP139fuD/8xNu4in3qSz/xq6vfjnJk86WOps4udyiXcd6/bf78/frVHqhPRen75fv4JX7fODHVIZlt20Px5d9ZtjAFfLEvl+ybEbtF5Z6U79ug/7o8rN2X3cvy6NV//vZW5sg/7t/suy6TNve/Vnl1tWzG8L2R1eYDR9EVmXxY0hboAKf63XN5eqzF756bpab8wxwbNmftgtXCnDIuIr4u8XVIdts3b7vnWxPRbRWNW21dR+1WKsWX79tlRkG9dl9snXPYeePOngGKHPmnOSQ29z9cJm2+lIE+2V+NGLKDeJufR9EVBfCwpC3QcPE2N8plRcVTHGemLLnF9qA8+sD28dX8XKSONwFdHUqXC8lu2+SXLXb2n/mzOA082uDWdb3gVnLiy/eLoF8aa/cO6uuyUerzhd1smSPmhflxAdj8quuaZgyHU30jnjK64gRVLvkk0FFKfL2D7pU5IK6WbvHKHhfFn6uLlPi66VSFZLdt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" alt="plot of chunk unnamed-chunk-18"/> </p>

<p>Here we have used local regression for the age term, with a span of 0.7.
 We can also use the lo() function to create interactions before calling the gam() function.
For example Lets see if we need a nonlinear terms for year:</p>

<pre><code class="r">gam.lo.i = gam(wage ~ lo(year, age, span = 0.5) + education, data = Wage)
library(akima)
</code></pre>

<pre><code>## Error: there is no package called &#39;akima&#39;
</code></pre>

<pre><code class="r">plot(gam.lo.i)
</code></pre>

<pre><code>## Loading required package: akima
</code></pre>

<pre><code>## Warning: there is no package called &#39;akima&#39;
</code></pre>

<pre><code>## Error: You need to install and load the package &#39;akima&#39; from the R
## contributed libraries
</code></pre>

<p>In order to fit a logistic regression GAM, we once again use the I() function in constructing the binary response variable, and set family=binomial.</p>

<pre><code class="r">gam.lr = gam(I(wage &gt; 250) ~ year + s(age, df = 5) + education, family = binomial, 
    data = Wage)
par(mfrow = c(1, 3))
plot(gam.lr, se = T, col = &quot;green&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAA2FBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrUA/wA5AAA5ADk5AGU5OQA5OTk5OWU5OY85ZrU5j485j7U5j9plAABlADllAGVlOQBlOTllOY9lZjllZmVlZrVlj9pltbVltf2POQCPOTmPOWWPZgCPZjmPZmWPZo+PjzmPj7WPj9qPtY+Ptf2P29qP2/21ZgC1Zjm1ZmW1jzm1j4+1tWW124+129q1/rW1/v3ajznaj2Xaj4/atWXatbXa24/a29ra/rXa/tra/v39tWX9tY/924/9/rX9/tr9/v39mD8vAAAASHRSTlP//////////////////////////////////////////////////////////////////////////////////////////////wCc7PJgAAAACXBIWXMAAAsSAAALEgHS3X78AAAaJUlEQVR4nO2dCXvjRnKGFyPHouJ4PYnkTcbWhjOT7OyRlWZ2c4hxDq8YHv//HwUNkhKOvqqrqlGNru/xWAKJOoBXXdU4CP7iqKpSv5g7AdU8UvCVSsFXKgVfqRR8pVLwlUrBVyoFX6kUfKVS8JVKwVcqBV+pFHylUvCVSsFXKgVfqRR8pVLwlUrBVyoFX6kUfKVS8Jm0v+8vbdfm3/6uuXpqlzZNc/363u7XVgeHj0/dz5eVt7fb2/FKUZ46Kfg82t1c9xdP4Dfro2G3bd/arLffXv22ada7m6/suLbd38hx97Zd+XZ38+bBgDc/93dvflibX2I9dVLwmfQy4jeNYd00HRpD6/if5n/dn0D7v88P03FsdPj0mw58+8fS6vPD7q0Bb35u1of3a/NLpKeTFHwmncF32C8j3hSCW4Pr8L4xdXt30/zdxyd7gd6uv7yCb8v+/t6Af2xLe/v6Zv3Y1fgoTycp+EwajfgO/OO6q9ymQO9+3eL68uQep5fuvfvuuS31ryO++1N4XH8+jfUYTycp+ExqwW/XL0uTyd1VS6r9+dVbd2duYa6P57+A1x7f3LZevl2bX6I9GSn4Jeg03kFS8MVrOziEi5WCr1QKvlIp+Eql4CuVgq9UCr5SKfhKpeArVST4Jq+SN0fzjM0zFnzyJqYIsUMJs+CMNn+eCh6hkvNU8AiVnKeCR6jkPBU8QiXn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" alt="plot of chunk unnamed-chunk-20"/> </p>

<p>It is easy to see that there are no high earners in the &lt;HS category:</p>

<pre><code class="r">table(education, I(wage &gt; 250))
</code></pre>

<pre><code>##                     
## education            FALSE TRUE
##   1. &lt; HS Grad         268    0
##   2. HS Grad           966    5
##   3. Some College      643    7
##   4. College Grad      663   22
##   5. Advanced Degree   381   45
</code></pre>

<p>Hence, we fit a logistic regression GAM using all but this category. This
provides more sensible results.</p>

<pre><code class="r">gam.lr.s = gam(I(wage &gt; 250) ~ year + s(age, df = 5) + education, family = binomial, 
    data = Wage, subset = (education != &quot;1. &lt; HS Grad&quot;))
plot(gam.lr.s, se = T, col = &quot;green&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-22"/> <img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-22"/> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAjVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlOTllOY9lZmVlj49ltdpltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP2/21ZgC124+1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v3FWFWxAAAAL3RSTlP/////////////////////////////////////////////////////////////AFqlOPcAAAAJcEhZcwAACxIAAAsSAdLdfvwAAA08SURBVHic7Z2JeqPIFUYHd8axp+PY7c5mO5PEzlgTa3v/xwtFAZLcpRJIBRT3P+dzt2yWq7ocagEh+GkLkvw0dQFgGhAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEizK4+NVtUTw1v399r/9fPxTFl3c/dVkUxc0P622en36YFmO5C7g9CB9bo7j+aMv59d0Xb1AWxUExv736Xzom6xdzW3S3Tc9laPEut9UvdX6t+PVDWe6F3+rLckNsnu8/r9hTvAu9aHaf/fBHWTgBb+1C44h/O0hq+bc67X7iXTGrFC9haPFLJ6NJtxXvy17t73Uydx+rP33/8l63D2WN/fl778xacW34Mo7brV7+VRT3ZQW/39ZTtvvv7ifVparnuwL85XW3dCI2L68Hf/3nrx91sn+/+3Bzff6ru1+bzXD1ul+k7614t8UOC1ttv92UU+Ueo49vW7RW/OZ5v6bVv9w++fahnPB2XzbEvcW3Nb4N7+Jcf2yeb8roN01kv9iyLYFfqBZfz3fTym3eLp0I1wXt8irduSpRJfuPcpdY3f3u81/d1uV+ci97RSp24t2mOiis2357U06VewTxu3bc907VzljWv6tqd3B7rp9Z7wHrx/fyp3cfXwa/2lUnH97FKTeQq2fuX/lr1Qw8ujdatv2CX8iLr+dXBXjZWzoRrtPb1frFvStFnWz5x+K+Lo/bFG3Xs1+kXVO/V7y6sFV7VU/pUO7hxa8f2v57N7ir/qq6/irJ21KTn/zm9ovq17feNb5t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" alt="plot of chunk unnamed-chunk-22"/> </p>

<pre><code class="r">gam2a = gam(I(wage &gt; 250) ~ s(age, df = 4) + year + education, data = Wage, 
    family = binomial)
anova(gam2a, gam2, test = &quot;Chisq&quot;)
</code></pre>

<pre><code>## Analysis of Deviance Table
## 
## Model 1: I(wage &gt; 250) ~ s(age, df = 4) + year + education
## Model 2: I(wage &gt; 250) ~ s(age, df = 4) + s(year, df = 4) + education
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1      2990        604                     
## 2      2987        603  3    0.905     0.82
</code></pre>

<p>One nice feature of the <code>gam</code> package is that it knows how to plot the functions nicely,
even for models fit by <code>lm</code> and <code>glm</code>.</p>

<pre><code class="r">par(mfrow = c(1, 3))
lm1 = lm(wage ~ ns(age, df = 4) + ns(year, df = 4) + education, data = Wage)
plot.gam(lm1, se = T)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAA4VBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OTk5OWU5OY85ZmU5ZrU5j485j7U5j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVlZrVlj9pltdpltf2POQCPOTmPOWWPZgCPZjmPZmWPZo+PjzmPj2WPj7WPj9qPtY+Ptf2P29qP2/21ZgC1Zjm1ZmW1jzm1j4+1tWW124+129q1/rW1/tq1/v3ajznaj2Xaj4/atWXa24/a29ra/rXa/tra/v39tWX9tY/924/9/rX9/tr9/v2QGO0YAAAAS3RSTlP//////////////////////////////////////////////////////////////////////////////////////////////////wDLGfCsAAAACXBIWXMAAAsSAAALEgHS3X78AAAZ0UlEQVR4nO2dDZ8bt3HGA53q6iLL9qWU3ajSuZSUVGnTmndn13WPThr7WL58/w8UYPm2uwSwAHYADLDP87PMI7EzwAB/grPYt9/sIKgi/SZ3AyCIUgAaqkoAGqpKABqqSgAaqkoAGqpKABqqSgAaqkoAGqpKABqqSgAaqkoAGqpKABqqSgAaqkoAGqpKABqqSgAaqkoAGqpKABqqSgAaqkoAGqpKAHrK2ty2363m6t/mtbh6lO+WQrw4l62/tbhZiWeLxt3BtKuTo9VsNdPar6/FfP/HbxfmutTHK9FplUYAesJaX3fg2AO9nO8UdytZtJyvXl39SYj5+vq5Dei/NaZqe2m6vn62+Pnts38XzV+ykhtZ0PytgFavm9fP3s73heeKGy3fzWSjnv9+tlu+ktX+/LlQ369m230T1JZ385MT2bwfm7KzLwA9ZZ1m6KWY7ac/cSTt5waRZkpdze4Xhrn1oNV+Ym5M7xfrm+Vs9WJzq/5qKJdSfyugm9L59v18X3isfQ/k9uNPb55kXb978+vHR1mt/ELJf+sbte2+CQro9bcnJ/KjfdnZF4Cesg5ANzgfZ2jF5UwBvX0vVI4g84F/+vhoTTn203Dzei233dz+LOnb3N416UED9FZ9qoBWnz08yg/vOrnDviHqG/Wvqq6Hn25ltbOfF/JP+VWR2/7jvgl7oE9O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" alt="plot of chunk unnamed-chunk-24"/> </p>

</body>

</html>

